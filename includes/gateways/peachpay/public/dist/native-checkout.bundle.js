(()=>{var t={5449:function(t,e,n){!function(t){"use strict";var e,n=function(){try{if(t.URLSearchParams&&"bar"===new t.URLSearchParams("foo=bar").get("foo"))return t.URLSearchParams}catch(t){}return null}(),r=n&&"a=1"===new n({a:1}).toString(),a=n&&"+"===new n("s=%2B").get("s"),i=!n||((e=new n).append("s"," &"),"s=+%26"===e.toString()),o=l.prototype,c=!(!t.Symbol||!t.Symbol.iterator);if(!(n&&r&&a&&i)){var s;o.append=function(t,e){f(this.__URLSearchParams__,t,e)},o.delete=function(t){delete this.__URLSearchParams__[t]},o.get=function(t){var e=this.__URLSearchParams__;return this.has(t)?e[t][0]:null},o.getAll=function(t){var e=this.__URLSearchParams__;return this.has(t)?e[t].slice(0):[]},o.has=function(t){return v(this.__URLSearchParams__,t)},o.set=function(t,e){this.__URLSearchParams__[t]=[""+e]},o.toString=function(){var t,e,n,r,a=this.__URLSearchParams__,i=[];for(e in a)for(n=p(e),t=0,r=a[e];t<r.length;t++)i.push(n+"="+p(r[t]));return i.join("&")},!!a&&n&&!r&&t.Proxy?(s=new Proxy(n,{construct:function(t,e){return new t(new l(e[0]).toString())}})).toString=Function.prototype.toString.bind(l):s=l,Object.defineProperty(t,"URLSearchParams",{value:s});var u=t.URLSearchParams.prototype;u.polyfill=!0,u.forEach=u.forEach||function(t,e){var n=y(this.toString());Object.getOwnPropertyNames(n).forEach((function(r){n[r].forEach((function(n){t.call(e,n,r,this)}),this)}),this)},u.sort=u.sort||function(){var t,e,n,r=y(this.toString()),a=[];for(t in r)a.push(t);for(a.sort(),e=0;e<a.length;e++)this.delete(a[e]);for(e=0;e<a.length;e++){var i=a[e],o=r[i];for(n=0;n<o.length;n++)this.append(i,o[n])}},u.keys=u.keys||function(){var t=[];return this.forEach((function(e,n){t.push(n)})),h(t)},u.values=u.values||function(){var t=[];return this.forEach((function(e){t.push(e)})),h(t)},u.entries=u.entries||function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),h(t)},c&&(u[t.Symbol.iterator]=u[t.Symbol.iterator]||u.entries)}function l(t){((t=t||"")instanceof URLSearchParams||t instanceof l)&&(t=t.toString()),this.__URLSearchParams__=y(t)}function p(t){var e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'\(\)~]|%20|%00/g,(function(t){return e[t]}))}function d(t){return t.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(t){return decodeURIComponent(t)}))}function h(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return c&&(n[t.Symbol.iterator]=function(){return n}),n}function y(t){var e={};if("object"==typeof t)if(m(t))for(var n=0;n<t.length;n++){var r=t[n];if(!m(r)||2!==r.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");f(e,r[0],r[1])}else for(var a in t)t.hasOwnProperty(a)&&f(e,a,t[a]);else{0===t.indexOf("?")&&(t=t.slice(1));for(var i=t.split("&"),o=0;o<i.length;o++){var c=i[o],s=c.indexOf("=");-1<s?f(e,d(c.slice(0,s)),d(c.slice(s+1))):c&&f(e,d(c),"")}}return e}function f(t,e,n){var r="string"==typeof n?n:null!=n&&"function"==typeof n.toString?n.toString():JSON.stringify(n);v(t,e)?t[e].push(r):t[e]=[r]}function m(t){return!!t&&"[object Array]"===Object.prototype.toString.call(t)}function v(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(void 0!==n.g?n.g:"undefined"!=typeof window?window:this)}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";n(5449);var t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==t&&t,e="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,o="ArrayBuffer"in t;if(o)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&c.indexOf(Object.prototype.toString.call(t))>-1};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function p(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function f(t){var e=new FileReader,n=y(e);return e.readAsArrayBuffer(t),n}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(t){var n;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:a&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:e&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o&&a&&((n=t)&&DataView.prototype.isPrototypeOf(n))?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=h(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(f)}),this.text=function(){var t,e,n,r=h(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=y(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(t,e){t=u(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},d.prototype.delete=function(t){delete this.map[u(t)]},d.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},d.prototype.set=function(t,e){this.map[u(t)]=l(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),p(t)},d.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),p(t)},d.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),p(t)},r&&(d.prototype[Symbol.iterator]=d.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,a=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,a||null==t._bodyInit||(a=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),_.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&a)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(a),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function g(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),a=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(a))}})),e}function w(t,e){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},v.call(b.prototype),v.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];w.redirect=function(t,e){if(-1===k.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})};var E=t.DOMException;try{new E}catch(t){(E=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),E.prototype.constructor=E}function S(e,n){return new Promise((function(r,i){var c=new b(e,n);if(c.signal&&c.signal.aborted)return i(new E("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var t,e,n={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new d,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var n=t.split(":"),r=n.shift().trim();if(r){var a=n.join(":").trim();e.append(r,a)}})),e)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var a="response"in s?s.response:s.responseText;setTimeout((function(){r(new w(a,n))}),0)},s.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},s.onabort=function(){setTimeout((function(){i(new E("Aborted","AbortError"))}),0)},s.open(c.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?s.withCredentials=!0:"omit"===c.credentials&&(s.withCredentials=!1),"responseType"in s&&(a?s.responseType="blob":o&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(s.responseType="arraybuffer")),!n||"object"!=typeof n.headers||n.headers instanceof d?c.headers.forEach((function(t,e){s.setRequestHeader(e,t)})):Object.getOwnPropertyNames(n.headers).forEach((function(t){s.setRequestHeader(t,l(n.headers[t]))})),c.signal&&(c.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&c.signal.removeEventListener("abort",u)}),s.send(void 0===c._bodyInit?null:c._bodyInit)}))}S.polyfill=!0,t.fetch||(t.fetch=S,t.Headers=d,t.Request=b,t.Response=w)})(),(()=>{"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},n.apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,c)}s((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(t){c=[6,t],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}Object.create;function i(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,a,i=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(t){a={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o}Object.create;var c="PP_SESSION_KEY";function s(){var t,e;return{key:"session_".concat((t=(new Date).getTime(),e=(null===performance||void 0===performance?void 0:performance.now)&&1e3*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var r=16*Math.random();return t>0?(r=(t+r)%16|0,t=Math.floor(t/16)):(r=(e+r)%16|0,e=Math.floor(e/16)),("x"===n?r:7&r|8).toString(16)})))),created_on:(new Date).toJSON()}}function u(){return function(t){if(!t)return s();var e=JSON.parse(t),n=new Date,r=new Date(e.created_on);return n.getMilliseconds()-r.getMilliseconds()>432e6?s():e}(function(){try{return sessionStorage.getItem(c)}catch(t){return null}}())}function l(){!function(t){try{sessionStorage.setItem(c,JSON.stringify(t))}catch(t){return!1}}(u())}function p(){return u().key}function d(t,e){void 0===e&&(e=null);var n=document.querySelector(t);return n&&null!==e&&e(n),n}function h(t,e){var n,r,a=Array.from(document.querySelectorAll(t));if(e)try{for(var o=i(a),c=o.next();!c.done;c=o.next()){e(c.value)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function y(t,e){void 0===e&&(e="a");var n=document.createElement("div");return n.innerHTML=t,e&&n.querySelectorAll(e).forEach((function(t){t.remove()})),n.textContent||n.innerText||""}function f(t,e){return r(this,void 0,void 0,(function(){var n,r;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,fetch(t.plugin.api_url_base+"api/v1/transaction/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:{id:p(),merchant_id:t.merchant.id,merchant_name:t.merchant.name,merchant_url:t.merchant.domain,plugin_version:t.plugin.version,platform:"woocommerce"},transaction:{transaction_location:"checkout-page",payment_method:e,payment_method_variation:null}})})];case 1:return[4,(n=a.sent()).json()];case 2:return r=a.sent(),n.ok&&r.success?[2,r.data.transaction_id]:[2,null];case 3:return a.sent(),[2,null];case 4:return[2]}}))}))}function m(t,e,n){return r(this,void 0,void 0,(function(){var r,i,o,c;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),r=t.plugin.api_url_base+"api/v1/transaction/update",i=JSON.stringify({session:{id:p(),merchant_id:t.merchant.id,merchant_name:t.merchant.name,merchant_url:t.merchant.domain,plugin_version:t.plugin.version},transaction:{id:e,note:n.note},order:{payment_status:n.paymentStatus,order_status:n.orderStatus}}),[4,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:i})];case 1:return[4,(o=a.sent()).json()];case 2:return c=a.sent(),o.ok&&c.success?[2,!0]:[2,!1];case 3:return a.sent(),[2,!1];case 4:return[2]}}))}))}function v(t,e,n){var r=document.createElement("input");r.type="hidden",r.name="peachpay_transaction_id",r.value=e,t.insertAdjacentElement("beforeend",r);var a=document.createElement("input");a.type="hidden",a.name="peachpay_session_id",a.value=n,t.insertAdjacentElement("beforeend",a)}function _(){h('input[name="peachpay_transaction_id"]',(function(t){t.remove()})),h('input[name="peachpay_session_id"]',(function(t){t.remove()}))}function b(){var t;return null!==(t=document.querySelector("form.checkout"))&&void 0!==t?t:document.querySelector("#order_review")}function g(t){var e=this;jQuery(document.body).on("updated_checkout",(function(){return r(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,t()];case 1:return e.sent(),[2]}}))}))}))}function w(t){return r(this,void 0,void 0,(function(){var e,n,i,o=this;return a(this,(function(c){switch(c.label){case 0:return(e=b())?(n=new FormData(e),i=n.get("payment_method"),[4,t(i)]):[2];case 1:return c.sent(),A((function(){return r(o,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return(e=b())?(n=new FormData(e),r=n.get("payment_method"),[4,t(r)]):[2];case 1:return a.sent(),[2]}}))}))})),[2]}}))}))}function k(t,e,n){var i=this;g((function(){var e=t.querySelector("#pp-stripe-form-submit");e&&jQuery(e).on("submit",(function(e){return r(i,void 0,void 0,(function(){var n;return a(this,(function(r){return e.preventDefault(),e.stopPropagation(),(n=t.querySelector("#place_order"))&&jQuery(n).trigger("click"),[2]}))}))}))})),jQuery(t).on("click",(function(o){return r(i,void 0,void 0,(function(){var r,i,c;return a(this,(function(a){switch(a.label){case 0:if(!jQuery(o.target).closest("#place_order").length)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),r=new FormData(t),(i=r.get("payment_method"))&&e.includes(i)?(jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o.preventDefault(),o.stopPropagation(),[4,n(i)]):[2];case 2:return a.sent()?jQuery(t).trigger("submit"):(jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock()),[3,4];case 3:return c=a.sent(),console.error(c),jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock(),[3,4];case 4:return[2]}}))}))}))}function E(t,e){var n=this,i=Object.keys(e);jQuery(t).on("click",(function(o){return r(n,void 0,void 0,(function(){var n,r,c,s;return a(this,(function(a){switch(a.label){case 0:if(!jQuery(o.target).closest("#place_order").length)return[2];a.label=1;case 1:return a.trys.push([1,4,,5]),n=new FormData(t),(r=n.get("payment_method"))&&i.includes(r)?(o.preventDefault(),o.stopPropagation(),jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),[4,e[r]]):[2];case 2:return(c=a.sent())?[4,c(t,r)]:[2];case 3:return a.sent()?jQuery(t).trigger("submit"):(jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock()),[3,5];case 4:return s=a.sent(),console.error(s),jQuery(document.body).trigger("checkout_error"),jQuery(t).unblock(),[3,5];case 5:return[2]}}))}))}))}function S(t){return r(this,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e,n){var r=null,a=null,i=function(){r&&window.removeEventListener("hashchange",r,!1),a&&jQuery(document.body).off("checkout_error",a)};r=function(){var r=o(location.hash.split("="),2),a=r[0],c=r[1];if("#payment_data"!==a||!c)return i(),void n(new Error("Invalid url hash payment data: "+location.hash));var s=JSON.parse(atob(decodeURIComponent(c)));s.type===t?(history.replaceState("",document.title,window.location.pathname+window.location.search),i(),e(s)):n(new Error("Invalid url hash payment data type. Expected: "+t+" but got: "+s.type))},a=function(){i(),n(x().join("\n"))},window.addEventListener("hashchange",r,!1),jQuery(document.body).on("checkout_error",a);var c=b();c?jQuery(c).trigger("submit"):n(new Error("Unable to locate checkout form for submission."))}))]}))}))}function x(){var t,e,n=[],r=d("ul.woocommerce-error");if(r)try{for(var a=i(Array.from(r.querySelectorAll("li"))),o=a.next();!o.done;o=a.next()){var c=o.value;n.push(y(c.innerHTML).trim())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return n}function P(t,e,n){var i=this;jQuery(document.body).on("checkout_error",(function(){return r(i,void 0,void 0,(function(){var r,i,o,c;return a(this,(function(a){switch(a.label){case 0:return r=function(){var t,e;return null!==(e=null===(t=d('input[name="peachpay_transaction_id"]'))||void 0===t?void 0:t.value)&&void 0!==e?e:null}(),_(),i=new FormData(t),o=i.get("payment_method"),[4,e[o]];case 1:return c=a.sent(),o&&c?[4,n(r,x())]:[2];case 2:return a.sent(),[2]}}))}))}))}function A(t){var e=b();e&&new MutationObserver(t).observe(e,{childList:!0,subtree:!0})}function T(t){return function(){var e=document.querySelector("li.wc_payment_method.payment_method_"+t);e&&e.remove()}}function L(t){var e="wc-".concat(t,"-payment-token"),n=d('input[type="radio"][name="'.concat(e,'"]:checked'));return!!n&&"new"!==n.value}function I(t){return{get:function(){return jQuery('input[name="'.concat(t,'"],select[name="').concat(t,'"]')).val()},set:function(e){jQuery('input[name="'.concat(t,'"],select[name="').concat(t,'"]')).val(e).trigger("change")}}}function j(t){return{get:function(){var e,n;return null!==(n=null===(e=d('input[name="'.concat(t,'"]')))||void 0===e?void 0:e.checked)&&void 0!==n&&n},set:function(e){d('input[name="'.concat(t,'"]'),(function(t){t.checked=e}))}}}function F(t){return{get:function(){return j("ship_to_different_address").get()?I("shipping_".concat(t)).get():I("billing_".concat(t)).get()},set:function(e){j("ship_to_different_address").get()?I("shipping_".concat(t)).set(e):I("billing_".concat(t)).set(e)}}}document.addEventListener("DOMContentLoaded",(function(){var t="",e=!1;A((function(){var n,r,a=b();if(a){var i=new FormData(a).get("payment_method");if(i!==t){t=i;var o=d("div.payment_box.payment_method_".concat(i)),c=null===(r=null===(n=null==o?void 0:o.querySelector("div[data-should-refresh-checkout]"))||void 0===n?void 0:n.dataset)||void 0===r?void 0:r.shouldRefreshCheckout;("true"===c||e)&&(e="true"===c,jQuery(document.body).trigger("update_checkout",{update_shipping_method:!1}))}}}))}));var C={billing:{email:I("billing_email"),phone:I("billing_phone"),firstName:I("billing_first_name"),lastName:I("billing_last_name"),address1:I("billing_address_1"),address2:I("billing_address_2"),city:I("billing_city"),state:I("billing_state"),postcode:I("billing_postcode"),country:I("billing_country")},differentShippingAddress:j("ship_to_different_address"),shipping:{email:F("email"),phone:F("phone"),firstName:F("first_name"),lastName:F("last_name"),address1:F("address_1"),address2:F("address_2"),city:F("city"),state:F("state"),postcode:F("postcode"),country:F("country")}},q=function(t){var e,n;return null!==(n=null===(e=peachpay_checkout_data.plugin.feature_support[t])||void 0===e?void 0:e.enabled)&&void 0!==n&&n},O=function(t,e,n){var r,a;return void 0===n&&(n=null),null!==(a=null===(r=peachpay_checkout_data.plugin.feature_support[t])||void 0===r?void 0:r.metadata[e])&&void 0!==a?a:n};function z(t){var e=this;if(q("peachpay_square_gateways")&&window.Square){var n=O("peachpay_square_gateways","application_id"),i=O("peachpay_square_gateways","location_id");if(n&&i){var o=window.Square.payments(n,i),c=function(t){var e=function(){var t,e;if(peachpay_checkout_data.page.is_order_pay){var n=peachpay_checkout_data.order_pay_details;return{countryCode:null!==(t=O("peachpay_square_gateways","country"))&&void 0!==t?t:"US",currencyCode:null==n?void 0:n.currency,discounts:n.discount_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),lineItems:n.item_lines.map((function(t){return{id:t.id,label:t.label,amount:Number(t.total).toFixed(2)}})),taxLineItems:n.tax_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),total:{label:n.total_line.label,amount:Number(n.total_line.amount).toFixed(2)}}}return{countryCode:null!==(e=O("peachpay_square_gateways","country"))&&void 0!==e?e:"US",currencyCode:peachpay_checkout_data.cart_details.currency,discounts:peachpay_checkout_data.cart_details.discount_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),lineItems:peachpay_checkout_data.cart_details.item_lines.map((function(t){return{id:t.id,label:t.label,amount:Number(t.amount).toFixed(2)}})),taxLineItems:peachpay_checkout_data.cart_details.tax_lines.map((function(t){return{label:t.label,amount:Number(t.amount).toFixed(2)}})),total:{label:peachpay_checkout_data.cart_details.total_line.label,amount:Number(peachpay_checkout_data.cart_details.total_line.amount).toFixed(2)}}},n=t.paymentRequest(e()),r=new Event("pp-square-payment-request-update");return g((function(){self.dispatchEvent(r),n.update(e())})),n}(o),s={peachpay_square_card:B(o),peachpay_square_applepay:$(o,c),peachpay_square_googlepay:H(o,c),peachpay_square_ach:Q(o),peachpay_square_afterpay:J(o,c),peachpay_square_cashapp:G(o,c)};E(t,s),P(t,s,(function(t,n){return r(e,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:if(N(),!t)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,m(peachpay_checkout_data,t,{paymentStatus:"unperformed",orderStatus:"creationfailed",note:n.join(" ")})];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))}))}}}function N(){h('input[name="peachpay_square_source_id"]',(function(t){t.remove()})),h('input[name="peachpay_square_verification_id"]',(function(t){t.remove()}))}function R(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}}function M(){var t,e,n,r,a,i,o,c,s,u,l,p,h,y,f,m,v,_,b,g,w,k={addressLines:[null!==(e=null===(t=d('[name="billing_address_1"]'))||void 0===t?void 0:t.value)&&void 0!==e?e:"",null!==(r=null===(n=d('[name="billing_address_2"]'))||void 0===n?void 0:n.value)&&void 0!==r?r:""],email:null!==(i=null===(a=d('[name="billing_email"]'))||void 0===a?void 0:a.value)&&void 0!==i?i:"",familyName:null!==(c=null===(o=d('[name="billing_last_name"]'))||void 0===o?void 0:o.value)&&void 0!==c?c:"",givenName:null!==(u=null===(s=d('[name="billing_first_name"]'))||void 0===s?void 0:s.value)&&void 0!==u?u:"",city:null!==(p=null===(l=d('[name="billing_city"]'))||void 0===l?void 0:l.value)&&void 0!==p?p:"",countryCode:null!==(f=null!==(y=null===(h=d('[name="billing_country"]'))||void 0===h?void 0:h.value)&&void 0!==y?y:O("peachpay_square_gateways","country"))&&void 0!==f?f:"",phone:null!==(v=null===(m=d('[name="billing_phone"]'))||void 0===m?void 0:m.value)&&void 0!==v?v:"",state:null!==(b=null===(_=d('[name="billing_state"]'))||void 0===_?void 0:_.value)&&void 0!==b?b:"",postalCode:null!==(w=null===(g=d('[name="billing_postcode"]'))||void 0===g?void 0:g.value)&&void 0!==w?w:""};return Number(peachpay_checkout_data.cart_details.total_line.amount)>0?{intent:"CHARGE",amount:Number(peachpay_checkout_data.cart_details.total_line.amount).toFixed(2),currencyCode:peachpay_checkout_data.cart_details.currency,billingContact:k}:{intent:"STORE",billingContact:k}}function U(t){var e=function(){var e,n="";return null===(e=null==t?void 0:t.errors)||void 0===e||e.forEach((function(t){n+=t.message+". "})),n}();switch(R(e),t.status){case"OK":return t.token?[t.token,null,{}]:[null,null,{}];case"Cancel":return[null,null,{paymentStatus:"canceled",note:"Customer canceled the payment."}];case"Abort":return[null,null,{paymentStatus:"creationfailed",note:'Tokenize status "Abort": '+e}];case"Error":case"Invalid":return[null,null,{paymentStatus:"creationfailed",note:e}];default:return[null,null,{paymentStatus:"creationfailed",note:'Tokenize status "Unknown": '+e}]}}function D(t){return r(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){return[2,function(n,i){return r(e,void 0,void 0,(function(){var e,r,c,s,u,l;return a(this,(function(a){switch(a.label){case 0:return _(),N(),L(i)?[3,5]:[4,t()];case 1:return e=o.apply(void 0,[a.sent(),3]),r=e[0],c=e[1],s=e[2],r?[3,4]:[4,f(peachpay_checkout_data,i)];case 2:return(u=a.sent())?[4,m(peachpay_checkout_data,u,s)]:[2,!1];case 3:return a.sent(),[2,!1];case 4:!function(t,e,n){if(e){var r=document.createElement("input");r.type="hidden",r.name="peachpay_square_source_id",r.value=e,t.insertAdjacentElement("beforeend",r)}if(n){var a=document.createElement("input");a.type="hidden",a.name="peachpay_square_verification_id",a.value=n,t.insertAdjacentElement("beforeend",a)}}(n,r,c),a.label=5;case 5:return[4,f(peachpay_checkout_data,i)];case 6:return(l=a.sent())?(v(n,l,p()),[2,!0]):[2,!1]}}))}))}]}))}))}function B(t){return r(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(i){switch(i.label){case 0:return[4,t.card()];case 1:return e=i.sent(),A((function(){return r(n,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:if(!(t=d("#pp-square-card-element")))return[2];if(""!==t.innerHTML)return[3,6];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.detach()];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[4,e.attach(t)];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))})),[2,D((function(){return r(n,void 0,void 0,(function(){var n,r,i,c,s,u,l,p,d;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),c=U,[4,e.tokenize()];case 1:return n=o.apply(void 0,[c.apply(void 0,[a.sent()]),3]),r=n[0],n[1],i=n[2],r?[4,t.verifyBuyer(r,M())]:[2,[null,null,i]];case 2:return s=a.sent(),u=null!==(d=null==s?void 0:s.token)&&void 0!==d?d:null,[2,[r,u,i]];case 3:return l=a.sent(),R(p="Sorry something went wrong. Please refresh the page and try again."),l instanceof Error?[2,[null,null,{note:l.message}]]:[2,[null,null,{note:p}]];case 4:return[2]}}))}))}))]}}))}))}function $(t,e){return r(this,void 0,void 0,(function(){var n,i=this;return a(this,(function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.applePay(e)];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),A(T("peachpay_SQUARE_APPLEPAY_GATEWAY")),[3,4];case 4:return[2,D((function(){return r(i,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=U,[4,n.tokenize()];case 1:return[2,t.apply(void 0,[e.sent()])]}}))}))}))]}}))}))}function H(t,e){return r(this,void 0,void 0,(function(){var n,i=this;return a(this,(function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t.googlePay(e)];case 2:return n=o.sent(),[3,4];case 3:return o.sent(),A(T("peachpay_square_googlepay")),[3,4];case 4:return[2,D((function(){return r(i,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=U,[4,n.tokenize()];case 1:return[2,t.apply(void 0,[e.sent()])]}}))}))}))]}}))}))}function Q(t){return r(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(i){switch(i.label){case 0:e=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.ach({redirectURI:window.location.href,transactionId:"0"})];case 2:return(e=i.sent()).addEventListener("ontokenization",(function(t){})),[3,4];case 3:return i.sent(),A(T("peachpay_square_ach")),[3,4];case 4:return[2,D((function(){return r(n,void 0,void 0,(function(){var t,n,r;return a(this,(function(a){switch(a.label){case 0:return t=C.billing.firstName.get(),n=C.billing.lastName.get(),r=U,[4,e.tokenize({accountHolderName:"".concat(t," ").concat(n)})];case 1:return[2,r.apply(void 0,[a.sent()])]}}))}))}))]}}))}))}function J(t,e){return r(this,void 0,void 0,(function(){var n,i,o=this;return a(this,(function(c){switch(c.label){case 0:n=null,i=function(){return r(o,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:if(!(t=d("#pp-square-afterpay-element"))||!n)return[2];if(""!==t.innerHTML)return[3,6];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,n.detach()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[4,n.attach("#pp-square-afterpay-element")];case 5:e.sent(),e.label=6;case 6:return[2]}}))}))},c.label=1;case 1:return c.trys.push([1,4,,5]),[4,t.afterpayClearpay(e)];case 2:return n=c.sent(),[4,i()];case 3:return c.sent(),[3,5];case 4:return c.sent(),A(T("peachpay_square_afterpay")),[3,5];case 5:return A((function(){return r(o,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,i()];case 1:return t.sent(),[2]}}))}))})),[2,D((function(){return r(o,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=U,[4,n.tokenize()];case 1:return[2,t.apply(void 0,[e.sent()])]}}))}))}))]}}))}))}function G(t,e){return r(this,void 0,void 0,(function(){var n,i,o,c=this;return a(this,(function(s){switch(s.label){case 0:n=null,i=function(){return r(c,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:if(!(t=d("#pp-square-cashapp-element"))||!n)return[2];if(""!==t.innerHTML)return[3,6];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,n.detach()];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[4,n.attach("#pp-square-cashapp-element")];case 5:e.sent(),e.label=6;case 6:return[2]}}))}))},o=null,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,t.cashAppPay(e,{redirectURL:window.location.href,referenceId:"square_cashapp_button"})];case 2:return null==(n=s.sent())||n.addEventListener("ontokenization",(function(t){var e;(null===(e=t.detail)||void 0===e?void 0:e.tokenResult)&&(o=t.detail.tokenResult)})),self.addEventListener("pp-square-payment-request-update",(function(){return r(c,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,null==n?void 0:n.detach()];case 1:return t.sent(),[2]}}))}))})),[4,i()];case 3:return s.sent(),[3,5];case 4:return s.sent(),A(T("peachpay_square_cashapp")),[3,5];case 5:return A((function(){return r(c,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,i()];case 1:return t.sent(),[2]}}))}))})),[2,D((function(){return r(c,void 0,void 0,(function(){return a(this,(function(t){return null===o?[2,U({status:"Error",details:{method:"Cash App Pay"},errors:[new Error("Please attach a Cash App account to withdrawal funds from")]})]:[2,U(o)]}))}))}))]}}))}))}var K="https://js.stripe.com/v3",X=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,V="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",W=null,Y=function(t){return null!==W||(W=new Promise((function(e,n){if("undefined"!=typeof window)if(window.Stripe&&t&&console.warn(V),window.Stripe)e(window.Stripe);else try{var r=function(){for(var t=document.querySelectorAll('script[src^="'.concat(K,'"]')),e=0;e<t.length;e++){var n=t[e];if(X.test(n.src))return n}return null}();r&&t?console.warn(V):r||(r=function(t){var e=t&&!t.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(K).concat(e);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n}(t)),r.addEventListener("load",(function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))})),r.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(t){return void n(t)}else e(null)}))),W},Z=function(t,e,n){if(null===t)return null;var r=t.apply(void 0,e);return function(t,e){t&&t._registerWrapper&&t._registerWrapper({name:"stripe-js",version:"1.44.1",startTime:e})}(r,n),r},tt=Promise.resolve().then((function(){return Y(null)})),et=!1;tt.catch((function(t){et||console.warn(t)}));var nt=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];et=!0;var r=Date.now();return tt.then((function(t){return Z(t,e,r)}))},rt=function(){function t(t,e){this.stripe=t,this.elements=e}return t.prototype.init=function(){},t.prototype.displayPaymentError=function(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}},t}(),at=function(){function t(t){this.mounted=!1;var e={base:{color:"#333",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#6a6a6a"}}};this.$cardNumber=t.create("cardNumber",{style:e,placeholder:"Card number"}),this.$cardExpiry=t.create("cardExpiry",{style:e}),this.$cardCvc=t.create("cardCvc",{style:e,placeholder:"CVV"}),this.init()}return t.prototype.mount=function(){var t=this;if(!this.mounted){this.mounted=!0,A((function(){var e=d("#pp-stripe-card-element");if(e&&0!==Array.from(e.querySelectorAll('[class="loading-blur"]')).length){var n=d("#pp-stripe-card-number"),r=d("#pp-stripe-card-expiry"),a=d("#pp-stripe-card-cvc");n&&r&&a&&(n.innerHTML="",r.innerHTML="",a.innerHTML="",t.$cardNumber.mount(n),t.$cardExpiry.mount(r),t.$cardCvc.mount(a))}}));var e=d("#pp-stripe-card-number"),n=d("#pp-stripe-card-expiry"),r=d("#pp-stripe-card-cvc");e&&n&&r&&(e.innerHTML="",n.innerHTML="",r.innerHTML="",this.$cardNumber.mount(e),this.$cardExpiry.mount(n),this.$cardCvc.mount(r))}},t.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,t.createPaymentMethod({type:"card",card:this.$cardNumber,billing_details:At()})];case 1:if(n=a.sent(),r=n.paymentMethod,i=n.error){switch(i.code){case"incomplete_cvc":case"invalid_cvc":this.$cardCvc.focus();break;case"incomplete_expiry":case"invalid_expiry_year_past":this.$cardExpiry.focus();break;default:this.$cardNumber.focus()}return o=null!==(e=i.message)&&void 0!==e?e:"",setTimeout((function(){!function(t,e){"error"===e?(d("#pp-stripe-card-element",(function(t){t.classList.add("error")})),d("#pp-stripe-card-status",(function(t){t.classList.add("show"),t.classList.add("error")}))):d("#pp-stripe-card-status",(function(t){t.classList.add("show")}));d("#pp-stripe-card-status span",(function(e){e.innerHTML=t}))}(o,"error")}),10),[2,[null,{note:o}]]}return(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{note:"Failed to tokenize payment method."}]]}}))}))},t.prototype.init=function(){this.$cardNumber.on("focus",it("Enter your card number.")),this.$cardNumber.on("change",ct("Enter your card number.",this.$cardExpiry.focus)),this.$cardNumber.on("change",(function(t){d("#pp-stripe-card-brand img",(function(e){e.src="".concat(peachpay_checkout_data.plugin.asset_url_base,"/img/marks/").concat((null==t?void 0:t.brand)&&"unknown"!==t.brand?t.brand:"credit-card-regular",".svg")}))})),this.$cardNumber.on("blur",ot()),this.$cardExpiry.on("focus",it("Enter the expiration date.")),this.$cardExpiry.on("change",ct("Enter the expiration date.",this.$cardCvc.focus)),this.$cardExpiry.on("blur",ot()),this.$cardCvc.on("focus",it("Enter the security code.")),this.$cardCvc.on("change",ct("Enter the security code.")),this.$cardCvc.on("blur",ot())},t}();function it(t){return function(){d("#pp-stripe-card-element",(function(t){t.classList.add("focused")})),d("#pp-stripe-card-status",(function(t){t.classList.add("show")})),d("#pp-stripe-card-status span",(function(e){e.innerHTML=t}))}}function ot(){return function(){d("#pp-stripe-card-element",(function(t){t.classList.remove("focused"),t.classList.remove("error")})),d("#pp-stripe-card-status",(function(t){t.classList.remove("show"),t.classList.remove("error")})),d("#pp-stripe-card-status span",(function(t){t.innerHTML=""}))}}function ct(t,e){return function(n){d("#pp-stripe-card-element",(function(t){t.classList.remove("error")})),d("#pp-stripe-card-status",(function(t){t.classList.remove("error")})),n.error?(d("#pp-stripe-card-element",(function(t){t.classList.add("error")})),d("#pp-stripe-card-status",(function(t){t.classList.add("show"),t.classList.add("error")})),d("#pp-stripe-card-status span",(function(t){var e,r;t.innerHTML=null!==(r=null===(e=n.error)||void 0===e?void 0:e.message)&&void 0!==r?r:""}))):n.complete?(d("#pp-stripe-card-status",(function(t){t.classList.remove("show")})),d("#pp-stripe-card-status span",(function(t){t.innerHTML=""})),null==e||e()):(d("#pp-stripe-card-status",(function(t){t.classList.add("show")})),d("#pp-stripe-card-status span",(function(e){e.innerHTML=t})))}}function st(t,e,n){return r(this,void 0,void 0,(function(){var r,i,o,c;return a(this,(function(a){switch(a.label){case 0:return r=O("peachpay_stripe_gateways","setup_intent_url"),i=O("peachpay_stripe_gateways","setup_intent_nonce"),r&&i?((o=new FormData).append("security",i),o.append("session_id",t),o.append("payment_method_type",e),n&&o.append("payment_method",n),[4,fetch(r,{method:"POST",body:o})]):[2,null];case 1:return[4,a.sent().json()];case 2:return(c=a.sent()).success?[2,c.data.setup_intent_details.client_secret]:[2,null]}}))}))}var ut=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.$cardElement=new at(r.elements),r}return e(n,t),n.prototype.init=function(){this.$cardElement.mount()},n.prototype.gatewayId=function(){return"peachpay_stripe_card"},n.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i,c,s,u,l;return a(this,(function(a){switch(a.label){case 0:return[4,this.$cardElement.tokenize(this.stripe)];case 1:return n=o.apply(void 0,[a.sent(),2]),r=n[0],i=n[1],r?(peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details?peachpay_checkout_data.order_pay_details:peachpay_checkout_data.cart_details).is_only_free_trial?[4,st(t,"card",r)]:[2,[r,{}]]:[2,[null,i]];case 2:return(c=a.sent())?[4,this.stripe.confirmCardSetup(c)]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 3:return s=a.sent(),u=s.error,!(l=s.setupIntent)||u?[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==u?void 0:u.message)&&void 0!==e?e:"Failed to confirm setup intent."}]]:"succeeded"!==l.status?[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(l.status,")")}]]:[2,[l.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e,n;return r(this,void 0,void 0,(function(){var r,i,o,c,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return r=a.sent(),i=r.paymentIntent,o=r.error,!i||o?[2,[null,{note:null!==(e=null==o?void 0:o.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===i.status||"requires_capture"===i.status?[2,["success",{}]]:"requires_action"!==i.status?[3,3]:[4,this.stripe.confirmCardPayment(t)];case 2:if(c=a.sent(),s=c.paymentIntent,u=c.error,!s||u)return[2,[null,{note:null!==(n=null==u?void 0:u.message)&&void 0!==n?n:"Failed to confirm payment intent."}]];if("succeeded"===s.status)return[2,["success",{}]];a.label=3;case 3:return[2,[null,{note:"Failed to confirm payment intent with status(".concat(i.status,")")}]]}}))}))},n}(rt),lt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_bancontact"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=At(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"bancontact",billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmBancontactPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),pt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_giropay"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=At(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name),[4,this.stripe.createPaymentMethod({type:"giropay",billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmGiropayPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),dt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_affirm"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"affirm",billing_details:At()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmAffirmPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),ht=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return e(i,t),i.prototype.gatewayId=function(){return"peachpay_stripe_sofort"},i.prototype.tokenize=function(){var t,e;return r(this,void 0,void 0,(function(){var r,i,o,c;return a(this,(function(a){switch(a.label){case 0:return r={sofort:{country:C.billing.country.get()},billing_details:At()},peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(r.billing_details.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,r.billing_details.email=peachpay_checkout_data.order_pay_details.billing_email,r.sofort.country=null!==(t=peachpay_checkout_data.order_pay_details.billing_country)&&void 0!==t?t:""),[4,this.stripe.createPaymentMethod(n({type:"sofort"},r))];case 1:return i=a.sent(),o=i.paymentMethod,(c=i.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(e=c.message)&&void 0!==e?e:"Failed to tokenize payment method."}]]:(null==o?void 0:o.id)?[2,[o.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},i.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmSofortPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},i}(rt),yt=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$epsElement=n.create("epsBank",{}),g((function(){try{r.$epsElement.mount("#pp-eps-element")}catch(t){}}));try{r.$epsElement.mount("#pp-eps-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_eps"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=At(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name),[4,this.stripe.createPaymentMethod({type:"eps",eps:this.$epsElement,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmEpsPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),ft=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$p24Element=n.create("p24Bank",{}),g((function(){try{r.$p24Element.mount("#pp-p24-element")}catch(t){}}));try{r.$p24Element.mount("#pp-p24-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_p24"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=At(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"p24",p24:this.$p24Element,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmP24Payment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),mt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_klarna"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"klarna",billing_details:At()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmKlarnaPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),vt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.init=function(){g((function(){var t="afterpay";switch(C.billing.country.get()){case"GB":case"ES":case"FR":case"IT":t="clearpay"}h('#payment-methods-container img[gateway="peachpay_stripe_afterpay"]',(function(e){var n,r=null===(n=e.getAttribute("src"))||void 0===n?void 0:n.split("/"),a=null==r?void 0:r.splice(0,r.length-1).join("/");e.setAttribute("src",a+"/"+t.toLowerCase()+".svg")}))}))},n.prototype.gatewayId=function(){return"peachpay_stripe_afterpay"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.createPaymentMethod({type:"afterpay_clearpay",billing_details:At()})];case 1:return e=a.sent(),n=e.paymentMethod,(r=e.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=r.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==n?void 0:n.id)?[2,[n.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmAfterpayClearpayPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),_t=function(t){function n(e,n){var r=t.call(this,e,n)||this;r.$idealElement=n.create("idealBank"),g((function(){try{r.$idealElement.mount("#pp-stripe-ideal-element")}catch(t){}}));try{r.$idealElement.mount("#pp-stripe-ideal-element")}catch(t){}return r}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_ideal"},n.prototype.tokenize=function(){var t;return r(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(a){switch(a.label){case 0:return e=At(),peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details&&(e.name=peachpay_checkout_data.order_pay_details.billing_first_name+" "+peachpay_checkout_data.order_pay_details.billing_last_name,e.email=peachpay_checkout_data.order_pay_details.billing_email),[4,this.stripe.createPaymentMethod({type:"ideal",ideal:this.$idealElement,billing_details:e})];case 1:return n=a.sent(),r=n.paymentMethod,(i=n.error)?[2,[null,{paymentStatus:"creationfailed",note:null!==(t=i.message)&&void 0!==t?t:"Failed to tokenize payment method."}]]:(null==r?void 0:r.id)?[2,[r.id,{}]]:[2,[null,{paymentStatus:"creationfailed",note:"Payment failed to tokenize."}]]}}))}))},n.prototype.confirm=function(t,e){var n;return r(this,void 0,void 0,(function(){var r,i,o;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.confirmIdealPayment(t,{return_url:e})];case 1:return r=a.sent(),i=r.paymentIntent,(o=r.error)?[2,[null,{note:null!==(n=o.message)&&void 0!==n?n:"Failed to confirm payment."}]]:i?[2,["success",{}]]:[2,[null,{}]]}}))}))},n}(rt),bt=["BIF","CLP","DJF","GNF","JPY","KMF","KRW","MGA","PYG","RWF","UGX","VND","VUV","XAF","XOF","XPF"];function gt(t,e){var n=Number.parseFloat(t);return bt.includes(e)||(n*=100),Math.round(n)}var wt=function(t){function n(e,n){var r=t.call(this,e,n)||this;return r.paymentRequest=null,g((function(){var t;null===(t=r.paymentRequest)||void 0===t||t.update({currency:peachpay_checkout_data.cart_details.currency.toLowerCase(),total:{label:peachpay_checkout_data.cart_details.total_line.label,amount:gt(peachpay_checkout_data.cart_details.total_line.amount,peachpay_checkout_data.cart_details.currency)},displayItems:peachpay_checkout_data.cart_details.item_lines.map((function(t){return{label:t.label,amount:gt(t.amount,peachpay_checkout_data.cart_details.currency)}}))})})),r}return e(n,t),n.tokenizePaymentRequest=function(t){return new Promise((function(e){null==t||t.on("paymentmethod",(function(n){t=null,n.complete("success"),e([n.paymentMethod.id,{}])})),null==t||t.on("cancel",(function(){t=null,e([null,{note:"Payment was canceled by customer"}])})),null==t||t.show()}))},n.prototype.init=function(t){return void 0===t&&(t=!0),r(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.paymentRequest=this.stripe.paymentRequest(function(){var t,e;return e=peachpay_checkout_data.page.is_order_pay&&peachpay_checkout_data.order_pay_details?peachpay_checkout_data.order_pay_details:peachpay_checkout_data.cart_details,{country:null!==(t=O("peachpay_stripe_gateways","country"))&&void 0!==t?t:"US",currency:e.currency.toLowerCase(),total:{label:e.total_line.label,amount:gt(e.total_line.amount,e.currency)},displayItems:e.item_lines.map((function(t){return{label:t.label,amount:gt(t.amount,e.currency)}}))}}()),[4,this.paymentRequest.canMakePayment()];case 1:return e=r.sent(),"googlepay"===this.paymentRequestType()&&!(null==e?void 0:e.googlePay)&&t||"applepay"===this.paymentRequestType()&&!(null==e?void 0:e.applePay)&&t?(A(T(this.gatewayId())),T(this.gatewayId())(),[2]):[3,3];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}}))}))},n.prototype.tokenize=function(t){var e;return r(this,void 0,void 0,(function(){var r,i,c,s,u,l,p,d;return a(this,(function(a){switch(a.label){case 0:return this.paymentRequest?[3,2]:[4,this.init(!1)];case 1:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Failed to tokenize payment method because paymentRequest object is not initialized."}]];case 2:return r=this.paymentRequest,this.paymentRequest=null,[4,n.tokenizePaymentRequest(r)];case 3:return i=o.apply(void 0,[a.sent(),2]),c=i[0],s=i[1],c?[3,5]:[4,this.init(!1)];case 4:return a.sent(),[2,[null,s]];case 5:return[4,st(t,"card",c)];case 6:return(u=a.sent())?[3,8]:[4,this.init(!1)];case 7:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 8:return[4,this.stripe.confirmCardSetup(u)];case 9:return l=a.sent(),p=l.error,(d=l.setupIntent)&&!p?[3,11]:[4,this.init(!1)];case 10:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==p?void 0:p.message)&&void 0!==e?e:"Failed to confirm setup intent."}]];case 11:return"succeeded"===d.status?[3,13]:[4,this.init(!1)];case 12:return a.sent(),[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(d.status,")")}]];case 13:return[4,this.init(!1)];case 14:return a.sent(),[2,[d.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return n=a.sent(),r=n.paymentIntent,i=n.error,!r||i?[2,[null,{note:null!==(e=null==i?void 0:i.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===r.status||"requires_capture"===r.status?[2,["success",{}]]:[2,[null,{note:"Failed to confirm payment intent with status(".concat(r.status,")")}]]}}))}))},n}(rt),kt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_googlepay"},n.prototype.paymentRequestType=function(){return"googlepay"},n}(wt),Et=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_applepay"},n.prototype.paymentRequestType=function(){return"applepay"},n}(wt),St=function(){function t(t,e){this.storeName=t,this.customerFullName=e,this.mandateElement=null,this.mandateElementAccept=null,this.mandateElementCancel=null,this.mandateElementX=null}return t.prototype.confirm=function(){return r(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,new Promise((function(e,n){var r,a,i;if(!t.mount())return t.unmount(),void n(new Error("Developer error: Mandate failed to be mounted."));null===(r=t.mandateElementAccept)||void 0===r||r.addEventListener("click",(function(){t.unmount(),e(!0)})),null===(a=t.mandateElementCancel)||void 0===a||a.addEventListener("click",(function(){t.unmount(),e(!1)})),null===(i=t.mandateElementX)||void 0===i||i.addEventListener("click",(function(){t.unmount(),e(!1)}))}))]}))}))},t.prototype.mount=function(){var t=this,e=document.createElement("div");return e.innerHTML=this.renderTemplate(),this.mandateElement=e.querySelector("#ach-mandate-container"),!!this.mandateElement&&(d("body",(function(e){return e.insertAdjacentElement("beforeend",t.mandateElement)})),this.mandateElementAccept=this.mandateElement.querySelector("#ach-button-accept"),!!this.mandateElementAccept&&(this.mandateElementCancel=this.mandateElement.querySelector("#ach-button-cancel"),!!this.mandateElementCancel&&(this.mandateElementX=this.mandateElement.querySelector("#ach-button-x"),!!this.mandateElementX)))},t.prototype.unmount=function(){var t;null===(t=this.mandateElement)||void 0===t||t.remove(),this.mandateElement=null,this.mandateElementAccept=null,this.mandateElementCancel=null,this.mandateElementX=null},t.prototype.renderTemplate=function(){var t=(new Date).toLocaleDateString(),e=null===this.customerFullName?"":"<p>Name: ".concat(this.customerFullName,"</p>");return'\n<div id="ach-mandate-container">\n    <div id="ach-mandate-modal">\n        <div id="ach-mandate-header">\n            <button type="button" id="ach-button-x" class="txt-btn" style="font-size: 2rem;">×</button>\n        </div>\n        <div id="ach-mandate-body">\n            <span>\n                '.concat(e,"\n                <p>Date: ").concat(t,'</p>\n            </span>\n            <br>\n            <p>\n                By clicking <b>Accept</b>, you authorize <span class="client">').concat(this.storeName,'</span> to debit the bank account specified above for any amount owed\n                for charges arising from your use of <span class="client">').concat(this.storeName,'\'s</span> services and/or purchase of products from\n                <span class="client">').concat(this.storeName,'</span>, pursuant to <span class="client">').concat(this.storeName,'\'s</span> website and terms, until this authorization\n                is revoked. You may amend or cancel this authorization at any time by providing notice to <span class="client">').concat(this.storeName,'</span>with 30\n                (thirty) days notice.\n            </p>\n            <br>\n            <div style="text-align: center;">\n                <button type="button" id="ach-button-accept" class="btn" style="padding: 9px; width: 7rem;">Accept</button>\n                <button type="button" id="ach-button-cancel" class="txt-btn">Cancel</button>\n            </div>\n        </div>\n    </div>\n    <style>\n        #ach-mandate-container{\n            position: fixed;\n            left: 0;\n            right: 0;\n            top: 0;\n            bottom: 0;\n            background-color: rgba(0,0,0,0.5);\n            animation-name: fadein;\n            animation-duration: 0.4s;\n            z-index: 1000000000000;\n        }\n\n        @keyframes fadein{\n            from {\n                background-color: rgba(0,0,0,0);\n            }\n            to {\n                background-color: rgba(0,0,0,0.5);\n            }\n        }\n\n        #ach-mandate-container .client{\n            border: 1px solid #e6e6e6;\n            border-radius: 0.2rem;\n            background-color: #e6e6e6;\n            padding: 0 4px;\n            margin-bottom: 1px;\n            display: inline-block;\n        }\n\n        #ach-mandate-modal{\n            position: absolute;\n            background-color: white;\n            border-radius: 0.4rem;\n            z-index: 10000000000;\n            width: 50vw;\n            box-shadow:  2px 8px 20px 3px rgb(0 0 0 / 20%);\n            margin: 0 calc(49vw / 2);\n            top: 10vh;\n        }\n\n        #ach-mandate-header{\n            padding: 0 0.5rem;\n            text-align: right;\n            border-bottom: 1px solid #e6e6e6;\n        }\n\n        #ach-mandate-body{\n            padding: 1.5rem;\n        }\n\n        #ach-mandate-body p {\n            margin: 0;\n            padding: 0;\n        }\n        \n        #ach-mandate-modal .txt-btn{\n            border: none;\n            background: none;\n            color: grey;\n            font-weight: 400;\n            padding: 0.1rem 1rem 0.1rem 0 !important;\n        }\n\n        #ach-mandate-modal .txt-btn:hover{\n            cursor: pointer;\n            color: red;\n        } \n\n        @media screen and (max-width: 768px) {\n\n            \n            #ach-mandate-modal{\n                width: 100%;\n                margin: 0;\n                left: 0;\n                right: 0;\n\n                animation-duration: 0.8s;\n                animation-name: slideup;\n                top: unset;\n                bottom: 0;\n                border-bottom-left-radius: 0;\n                border-bottom-right-radius: 0;\n            }\n\n            @keyframes slideup{\n                from {\n                    bottom: -100%\n                }\n                to {\n                    bottom: 0;\n                }\n            }\n\n        }\n\n        /*This prevents the background from being scrollable*/\n        body{\n            overflow: hidden !important;\n            touch-action: none !important;\n        }\n    </style>\n</div>')},t}(),xt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_stripe_achdebit"},n.prototype.tokenize=function(t){var e,n;return r(this,void 0,void 0,(function(){var r,i,o,c,s,u,l,p,d,h,y,f;return a(this,(function(a){switch(a.label){case 0:return[4,st(t,"us_bank_account")];case 1:return(r=a.sent())?[4,this.stripe.collectBankAccountForSetup({clientSecret:r,params:{payment_method_type:"us_bank_account",payment_method_data:{billing_details:{name:C.billing.firstName.get()+" "+C.billing.lastName.get()}}}})]:[2,[null,{paymentStatus:"creationfailed",note:"Failed to create setup intent."}]];case 2:if(i=a.sent(),o=i.error,!(c=i.setupIntent)||o)return[2,[null,{paymentStatus:"creationfailed",note:null!==(e=null==o?void 0:o.message)&&void 0!==e?e:"Failed to collect bank account for setup intent."}]];if("requires_confirmation"!==c.status)return[2,[null,{paymentStatus:"creationfailed",note:"The customer canceled choosing a bank account."}]];s=peachpay_checkout_data.merchant.name,u=C.billing.firstName.get()?C.billing.firstName.get()+" "+C.billing.lastName.get():null,l=new St(s,u),p=!1,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,l.confirm()];case 4:return p=a.sent(),[3,6];case 5:return d=a.sent(),console.error(d),[3,6];case 6:return p?[4,this.stripe.confirmUsBankAccountSetup(r)]:("The required mandate was not accepted. Payment canceled.",[2,[null,{note:"The required mandate was not accepted. Payment canceled."}]]);case 7:return h=a.sent(),y=h.error,!(f=h.setupIntent)||y?[2,[null,{paymentStatus:"creationfailed",note:null!==(n=null==y?void 0:y.message)&&void 0!==n?n:"Failed to confirm setup intent."}]]:"succeeded"!==f.status?[2,[null,{paymentStatus:"creationfailed",note:"Setup intent resulted in invalid status(".concat(f.status,")")}]]:[2,[f.payment_method,{}]]}}))}))},n.prototype.confirm=function(t){var e;return r(this,void 0,void 0,(function(){var n,r,i;return a(this,(function(a){switch(a.label){case 0:return[4,this.stripe.retrievePaymentIntent(t)];case 1:return n=a.sent(),r=n.paymentIntent,i=n.error,!r||i?[2,[null,{note:null!==(e=null==i?void 0:i.message)&&void 0!==e?e:"Failed to retrieve payment intent."}]]:"succeeded"===r.status||"processing"===r.status?[2,["success",{}]]:[2,[null,{note:"Failed to confirm payment intent with status(".concat(r.status,")")}]]}}))}))},n}(rt);function Pt(t){return r(this,void 0,void 0,(function(){var e,n,i,c,s,u=this;return a(this,(function(l){switch(l.label){case 0:return q("peachpay_stripe_gateways")?(e=O("peachpay_stripe_gateways","public_key"),n=O("peachpay_stripe_gateways","connect_id"),e&&n?[4,nt(e,{stripeAccount:n,locale:"auto"})]:[2]):[2];case 1:return(i=l.sent())?(c=i.elements(),s=[],q("peachpay_stripe_card_gateway")&&s.push(new ut(i,c)),q("peachpay_stripe_bancontact_gateway")&&s.push(new lt(i,c)),q("peachpay_stripe_giropay_gateway")&&s.push(new pt(i,c)),q("peachpay_stripe_affirm_gateway")&&s.push(new dt(i,c)),q("peachpay_stripe_sofort_gateway")&&s.push(new ht(i,c)),q("peachpay_stripe_eps_gateway")&&s.push(new yt(i,c)),q("peachpay_stripe_p24_gateway")&&s.push(new ft(i,c)),q("peachpay_stripe_klarna_gateway")&&s.push(new mt(i,c)),q("peachpay_stripe_afterpay_gateway")&&s.push(new vt(i,c)),q("peachpay_stripe_ideal_gateway")&&s.push(new _t(i,c)),q("peachpay_stripe_googlepay_gateway")&&s.push(new kt(i,c)),q("peachpay_stripe_applepay_gateway")&&s.push(new Et(i,c)),q("peachpay_stripe_achdebit_gateway")&&s.push(new xt(i,c)),[4,Promise.all(s.map((function(t){return t.init()})))]):[2];case 2:return l.sent(),g((function(){d("#payment_method_peachpay_stripe_card",(function(t){if(t.parentElement){var e=t.parentElement.querySelector(".payment_method_peachpay_stripe_card #pp-stripe-card-status");if(e){var n=document.createElement("form");n.setAttribute("id","pp-stripe-form-submit"),n.style.margin="0",e.before(n)}}})),d("#pp-stripe-card-element",(function(t){d("#pp-stripe-form-submit",(function(e){e.append(t)}))}))})),k(t,s.map((function(t){return t.gatewayId()})),(function(e){return r(u,void 0,void 0,(function(){var n,r,i,c,u;return a(this,(function(a){switch(a.label){case 0:return(n=s.find((function(t){return t.gatewayId()===e})))?(_(),h('input[name="peachpay_stripe_payment_method_id"]',(function(t){t.remove()})),r=null,L(e)?[4,f(peachpay_checkout_data,e)]:[3,2]):[2,!1];case 1:return(r=a.sent())?[3,7]:[2,!1];case 2:return[4,n.tokenize(p())];case 3:return i=o.apply(void 0,[a.sent(),2]),c=i[0],u=i[1],!c&&(null==u?void 0:u.note)&&n.displayPaymentError(u.note),[4,f(peachpay_checkout_data,e)];case 4:return(r=a.sent())?c?[3,6]:[4,m(peachpay_checkout_data,r,u)]:[2,!1];case 5:return a.sent(),[2,!1];case 6:!function(t,e){if(e){var n=document.createElement("input");n.type="hidden",n.name="peachpay_stripe_payment_method_id",n.value=e,t.insertAdjacentElement("beforeend",n)}}(t,c),a.label=7;case 7:return v(t,r,p()),[2,!0]}}))}))})),y="stripe",b=function(t){return r(u,void 0,void 0,(function(){var e,n,r,i,c;return a(this,(function(a){switch(a.label){case 0:if("stripe"!==t.type)return[2];if(!(e=s.find((function(e){return t.gateway===e.gatewayId()}))))return[2];a.label=1;case 1:return a.trys.push([1,5,,7]),[4,e.confirm(t.data.client_secret,t.intermediate_url)];case 2:return n=o.apply(void 0,[a.sent(),2]),r=n[0],i=n[1],r?[3,4]:[4,m(peachpay_checkout_data,t.transaction_id,i)];case 3:a.sent(),a.label=4;case 4:return"success"===r&&(window.location.href=t.success_url),[3,7];case 5:return c=a.sent(),[4,m(peachpay_checkout_data,t.transaction_id,{note:c.message,paymentStatus:"failed"})];case 6:return a.sent(),[3,7];case 7:return[2]}}))}))},window.addEventListener("hashchange",(function(){var t=o(location.hash.split("="),2),e=t[0],n=t[1];if("#payment_data"===e&&n){var r=JSON.parse(atob(decodeURIComponent(n)));r.type===y&&(history.replaceState("",document.title,window.location.pathname+window.location.search),b(r))}}),!1),[2]}var y,b}))}))}function At(){return C.billing.firstName.get()?{name:"".concat(C.billing.firstName.get()," ").concat(C.billing.lastName.get()),email:C.billing.email.get(),phone:C.billing.phone.get(),address:{city:C.billing.city.get(),country:C.billing.country.get(),line1:C.billing.address1.get(),line2:C.billing.address2.get(),postal_code:C.billing.postcode.get(),state:C.billing.state.get()}}:{}}var Tt=function(){function t(t){this.businessId=t.businessId,this.applicationId=t.applicationId,this.$cardElement=new TokenizeJs(this.businessId,this.applicationId)}return t.prototype.mount=function(t,e){this.$cardElement.mount(t,document,e)},t.prototype.tokenize=function(){return r(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,new Promise((function(e){t.$cardElement.on("nonce",(function(t){t.data.nonce&&e({nonce:t.data.nonce})})),t.$cardElement.on("error",(function(t){var n,r,a,i,o;e({error:null!==(o=null!==(r=null===(n=t.data)||void 0===n?void 0:n.message)&&void 0!==r?r:null===(i=null===(a=t.data)||void 0===a?void 0:a.error)||void 0===i?void 0:i.message)&&void 0!==o?o:"Something went wrong. Please try again."})})),t.$cardElement.getNonce({businessId:t.businessId})}))]}))}))},t}();function Lt(t){return r(this,void 0,void 0,(function(){var e,n,i,o,c,s,u=this;return a(this,(function(l){return q("peachpay_poynt_gateways")?(e=O("peachpay_poynt_gateways","poynt_src"),n=O("peachpay_poynt_gateways","business_id"),i=O("peachpay_poynt_gateways","application_id"),n&&i&&e?(q("peachpay_poynt_card_gateway")&&(o=new Tt({businessId:n,applicationId:i}),c={displayComponents:{labels:!0},iFrame:{border:"0px",borderRadius:"0px",boxShadow:"none",height:"232px",width:"auto"}},s="pp-poynt-card-element",o.mount(s,c),A((function(){var t=d("#pp-poynt-card-element");t&&""===t.innerHTML&&o.mount(s,c)})),k(t,["peachpay_poynt_card"],(function(e){return r(u,void 0,void 0,(function(){var n,r,i,c,s;return a(this,(function(a){switch(a.label){case 0:return h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""})),L(e)?[4,f(peachpay_checkout_data,e)]:[3,2];case 1:return(c=a.sent())?(v(t,c,p()),[3,7]):[2,!1];case 2:return[4,o.tokenize()];case 3:return n=a.sent(),r=n.nonce,i=n.error,[4,f(peachpay_checkout_data,e)];case 4:return(c=a.sent())?(null!=i?i:!r)?[4,m(peachpay_checkout_data,c,{paymentStatus:"creationfailed",orderStatus:"unperformed",note:null!=i?i:"An unknown error occured while retrieving the nonce."})]:[3,6]:[2,!1];case 5:return a.sent(),'.payment_box:not([style*="display:none"]):not([style*="display: none"])',h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(t){t.classList.remove("hide"),t.innerHTML=null!=i?i:"An unknown error occured while tokenizing the payment method."})),[2,!1];case 6:(s=document.createElement("input")).type="hidden",s.name="peachpay_poynt_nonce",s.value=r,t.insertAdjacentElement("beforeend",s),v(t,c,p()),a.label=7;case 7:return[2,!0]}}))}))}))),[2]):[2]):[2]}))}))}var It=function(){function t(t){this.loginId=t.loginId,this.clientKey=t.clientKey,this.scriptSrc=t.acceptSrc,this.$script=null,this.$button=null}return t.prototype.tokenize=function(e){return r(this,void 0,void 0,(function(){var n=this;return a(this,(function(r){switch(r.label){case 0:if(t.isTokenizing)throw new Error("Tokenization is already in progress. Only 1 tokenization attempt may occur at a time.");return t.isTokenizing=!0,[4,this.mount(e)];case 1:return r.sent(),[4,new Promise((function(t){setTimeout((function(){t()}),1e3)}))];case 2:return r.sent(),[2,new Promise((function(e,r){var a,o;n.$button||r(new Error("Failed to locate Authorize.net tokenize button")),window.peachpayAuthnetResponseHandler=function(n){"Ok"===n.messages.resultCode&&n.opaqueData?e({token:{descriptor:n.opaqueData.dataDescriptor,value:n.opaqueData.dataValue}}):"Error"===n.messages.resultCode?e({error:n.messages.message.map((function(t){return{code:t.code,message:t.text}}))}):r(new Error("Unhandled Authorize.net tokenization response.")),window.peachpayAuthnetResponseHandler=void 0,t.isTokenizing=!1},null===(a=n.$button)||void 0===a||a.click();var c=d("#AcceptUIContainer"),s=null===(o=d("#AcceptUIContainer"))||void 0===o?void 0:o.parentNode,u=new MutationObserver((function(n){var r,a;try{for(var o=i(n),s=o.next();!s.done;s=o.next()){var l=s.value;"childList"===l.type&&l.removedNodes[0]===c&&(u.disconnect(),e({cancel:!0}),window.peachpayAuthnetResponseHandler=void 0,t.isTokenizing=!1)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}}));s&&u.observe(s,{attributes:!1,childList:!0,subtree:!1})}))]}}))}))},t.prototype.mount=function(t){return r(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){return this.unmount(),[2,new Promise((function(n,r){var a={showCreditCard:"card"===t||"all"===t,showBankAccount:"bank"===t||"all"===t},i=document.createElement("button");i.classList.add("AcceptUI"),i.setAttribute("style","display: none;"),i.setAttribute("type","button"),i.setAttribute("data-billingAddressOptions",'{"show":false,"required":false}'),i.setAttribute("data-apiLoginID",e.loginId),i.setAttribute("data-clientKey",e.clientKey),i.setAttribute("data-acceptUIFormBtnTxt","Submit"),i.setAttribute("data-acceptUIFormHeaderTxt","Card Information"),i.setAttribute("data-paymentOptions",JSON.stringify(a)),i.setAttribute("data-responseHandler","peachpayAuthnetResponseHandler"),i.textContent="Pay",e.$button=i;var o=document.createElement("script");o.type="text/javascript",o.src=e.scriptSrc,o.classList.add("pp-authnet-accept-script"),o.onload=function(){n()},o.onerror=function(){r(new Error("Failed to load tokenization script."))},e.$script=o,document.body.appendChild(i),document.body.appendChild(o)}))]}))}))},t.prototype.unmount=function(){var t,e;null===(t=this.$script)||void 0===t||t.remove(),null===(e=this.$button)||void 0===e||e.remove(),h("#AcceptUIBackground,#AcceptUIContainer",(function(t){t.remove()}))},t.isTokenizing=!1,t}();function jt(t){return r(this,void 0,void 0,(function(){var e,n,i,o,c=this;return a(this,(function(s){return q("peachpay_authnet_gateways")?(e=O("peachpay_authnet_gateways","login_id"),n=O("peachpay_authnet_gateways","public_client_key"),i=O("peachpay_authnet_gateways","accept_src"),n&&e&&i?(o=new It({loginId:e,clientKey:n,acceptSrc:i}),k(t,["peachpay_authnet_card","peachpay_authnet_echeck"],(function(e){return r(c,void 0,void 0,(function(){var n,r,i,c,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,o.tokenize("peachpay_authnet_card"===e?"card":"bank")];case 1:return n=a.sent(),r=n.token,i=n.error,c=n.cancel,[4,f(peachpay_checkout_data,e)];case 2:return(s=a.sent())?c?[4,m(peachpay_checkout_data,s,{paymentStatus:"cancelled",orderStatus:"unperformed"})]:[3,4]:[2,!1];case 3:return a.sent(),[2,!1];case 4:return(null!=i?i:!r)?[4,m(peachpay_checkout_data,s,{paymentStatus:"creationfailed",orderStatus:"unperformed",note:null!==(u=null==i?void 0:i.map((function(t){return"".concat(t.code,": ").concat(t.message)})).join("\n"))&&void 0!==u?u:"An unknown error occured while tokenizing the payment method."})]:[3,6];case 5:return a.sent(),'.payment_box:not([style*="display:none"]):not([style*="display: none"])',h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])'," .peachpay-tokenize-error"),(function(t){var e;t.classList.remove("hide"),t.innerHTML=null!==(e=null==i?void 0:i.map((function(t){return"".concat(t.code,": ").concat(t.message)})).join("\n"))&&void 0!==e?e:"An unknown error occured while tokenizing the payment method."})),setTimeout((function(){h(".peachpay-tokenize-error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4),[2,!1];case 6:return v(t,s,p()),function(t,e,n){var r=document.createElement("input");r.type="hidden",r.name="peachpay_authnet_data_descriptor",r.value=e,t.insertAdjacentElement("beforeend",r);var a=document.createElement("input");a.type="hidden",a.name="peachpay_authnet_data_value",a.value=n,t.insertAdjacentElement("beforeend",a)}(t,r.descriptor,r.value),[2,!0]}}))}))})),[2]):[2]):[2]}))}))}function Ft(t){var e="https://www.paypal.com/sdk/js";t.sdkBaseURL&&(e=t.sdkBaseURL,delete t.sdkBaseURL),function(t){var e=t["merchant-id"],n=t["data-merchant-id"],r="",a="";Array.isArray(e)?e.length>1?(r="*",a=e.toString()):r=e.toString():"string"==typeof e&&e.length>0?r=e:"string"==typeof n&&n.length>0&&(r="*",a=n);t["merchant-id"]=r,t["data-merchant-id"]=a}(t);var n=Object.keys(t).filter((function(e){return void 0!==t[e]&&null!==t[e]&&""!==t[e]})).reduce((function(e,n){var r=t[n].toString();return"data-"===n.substring(0,5)?e.dataAttributes[n]=r:e.queryParams[n]=r,e}),{queryParams:{},dataAttributes:{}}),r=n.queryParams,a=n.dataAttributes;return{url:"".concat(e,"?").concat(Ct(r)),dataAttributes:a}}function Ct(t){var e="";return Object.keys(t).forEach((function(n){0!==e.length&&(e+="&"),e+=n+"="+t[n]})),e}function qt(t,e){void 0===e&&(e={});var n=document.createElement("script");return n.src=t,Object.keys(e).forEach((function(t){n.setAttribute(t,e[t]),"data-csp-nonce"===t&&n.setAttribute("nonce",e["data-csp-nonce"])})),n}function Ot(t,e){if(void 0===e&&(e=zt()),Rt(t,e),"undefined"==typeof window)return e.resolve(null);var n=Ft(t),r=n.url,a=n.dataAttributes,i=a["data-namespace"]||"paypal",o=Nt(i);return function(t,e){var n=document.querySelector('script[src="'.concat(t,'"]'));if(null===n)return null;var r=qt(t,e),a=n.cloneNode();if(delete a.dataset.uidAuto,Object.keys(a.dataset).length!==Object.keys(r.dataset).length)return null;var i=!0;return Object.keys(a.dataset).forEach((function(t){a.dataset[t]!==r.dataset[t]&&(i=!1)})),i?n:null}(r,a)&&o?e.resolve(o):function(t,e){void 0===e&&(e=zt());Rt(t,e);var n=t.url,r=t.attributes;if("string"!=typeof n||0===n.length)throw new Error("Invalid url.");if(void 0!==r&&"object"!=typeof r)throw new Error("Expected attributes to be an object.");return new e((function(t,e){if("undefined"==typeof window)return t();!function(t){var e=t.url,n=t.attributes,r=t.onSuccess,a=t.onError,i=qt(e,n);i.onerror=a,i.onload=r,document.head.insertBefore(i,document.head.firstElementChild)}({url:n,attributes:r,onSuccess:function(){return t()},onError:function(){var t=new Error('The script "'.concat(n,'" failed to load.'));return window.fetch?fetch(n).then((function(n){return 200===n.status&&e(t),n.text()})).then((function(t){var n=function(t){var e=t.split("/* Original Error:")[1];return e?e.replace(/\n/g,"").replace("*/","").trim():t}(t);e(new Error(n))})).catch((function(t){e(t)})):e(t)}})}))}({url:r,attributes:a},e).then((function(){var t=Nt(i);if(t)return t;throw new Error("The window.".concat(i," global variable is not available."))}))}function zt(){if("undefined"==typeof Promise)throw new Error("Promise is undefined. To resolve the issue, use a Promise polyfill.");return Promise}function Nt(t){return window[t]}function Rt(t,e){if("object"!=typeof t||null===t)throw new Error("Expected an options object.");if(void 0!==e&&"function"!=typeof e)throw new Error("Expected PromisePonyfill to be a function.")}var Mt=function(){function t(){this.paypal=null,this.button=null,this.isEligible=!1,this.isMounted=!1,this.mountContainer=null,this.currentPaymentDetails=null}return t.prototype.init=function(t){var e;this.paypal=t,this.button=this.createButtonComponent(),(null===(e=this.button)||void 0===e?void 0:e.isEligible())?this.isEligible=!0:(A(T(this.gatewayId())),T(this.gatewayId())(),this.isEligible=!1)},t.prototype.mount=function(){var e,n;if(this.paypal&&this.isEligible&&!this.isMounted&&!t.isOpen){if(d("#"+this.gatewayId()+"_button_container")||(this.mountContainer=null,this.button=null),!this.button){this.button=this.createButtonComponent();var i=b();i&&E(i,{peachpay_paypal_credit:function(){return r(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))},peachpay_paypal_paylater:function(){return r(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))},peachpay_paypal_wallet:function(){return r(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))},peachpay_paypal_venmo:function(){return r(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!1]}))}))}})}if(this.mountContainer)null===(e=this.mountContainer)||void 0===e||e.classList.remove("hide");else{var o=d(".place-order,.woocommerce-terms-and-conditions-wrapper");if(!o)return void console.error('Could not locate WC "Place order" button container! PayPal gateway "'.concat(this.gatewayId(),'" button not inserted.'));this.mountContainer=document.createElement("div"),this.mountContainer.setAttribute("id",this.gatewayId()+"_button_container"),null==o||o.insertAdjacentElement("beforeend",this.mountContainer),null===(n=this.button)||void 0===n||n.render("#"+this.gatewayId()+"_button_container").catch((function(){}))}this.isMounted=!0}},t.prototype.unmount=function(){var e;t.isOpen||this.isMounted&&(null===(e=this.mountContainer)||void 0===e||e.classList.add("hide"),this.isMounted=!1)},t.prototype.displayPaymentError=function(t){if(t){h("".concat('.payment_box:not([style*="display:none"]):not([style*="display: none"])',".peachpay - tokenize - error"),(function(e){e.classList.remove("hide"),e.innerHTML=t})),setTimeout((function(){h(".peachpay - tokenize - error",(function(t){t.classList.add("hide"),t.innerHTML=""}))}),1e4)}},t.prototype.createButtonComponent=function(){var e,n,i=this.gatewayId(),o=this;return null!==(n=null===(e=this.paypal)||void 0===e?void 0:e.Buttons({fundingSource:this.fundingType(),style:this.buttonStyle(),onClick:function(){t.isOpen=!0},createOrder:function(t,e){return r(this,void 0,void 0,(function(){var t,e,n,r,c;return a(this,(function(a){switch(a.label){case 0:return(t=b())?[4,f(peachpay_checkout_data,i)]:[2,""];case 1:if(!(e=a.sent()))return[2,""];v(t,e,p()),a.label=2;case 2:return a.trys.push([2,7,,8]),peachpay_checkout_data.page.is_order_pay?[4,Ut()]:[3,4];case 3:return r=a.sent(),[3,6];case 4:return[4,S("paypal")];case 5:r=a.sent(),a.label=6;case 6:return n=r,o.currentPaymentDetails=n,[2,n.data.id];case 7:return c=a.sent(),console.error(c),jQuery(t).unblock(),[2,""];case 8:return[2]}}))}))},onApprove:function(t,e){var n;return r(this,void 0,void 0,(function(){var t,r,i,c;return a(this,(function(a){switch(a.label){case 0:return(null===(n=o.currentPaymentDetails)||void 0===n?void 0:n.order_id)?(t=O("peachpay_paypal_gateways","approve_order_url"),r=O("peachpay_paypal_gateways","approve_order_security"),t&&r?((i=new FormData).append("security",r),i.append("order_id",o.currentPaymentDetails.order_id),[4,fetch(t,{method:"POST",body:i})]):(console.error("Missing required dependencies to Capture/Confirm PayPal order."),e.restart(),[2])):(console.error("Unknown Woocommerce Order"),e.restart(),[2]);case 1:return[4,a.sent().json()];case 2:return(c=a.sent()).success?(e.redirect(o.currentPaymentDetails.success_url),[2]):(console.error(c.message),e.restart(),[2])}}))}))},onCancel:function(t,e){return r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return o.currentPaymentDetails?[4,m(peachpay_checkout_data,o.currentPaymentDetails.transaction_id,{paymentStatus:"CANCELED",orderStatus:"canceled"})]:(console.error(t),[2]);case 1:return e.sent(),window.location.href=o.currentPaymentDetails.cancel_url,[2]}}))}))},onError:function(t){var e;return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return console.error(t),(null===(e=o.currentPaymentDetails)||void 0===e?void 0:e.transaction_id)?[4,m(peachpay_checkout_data,o.currentPaymentDetails.transaction_id,{note:JSON.stringify(t)})]:[3,2];case 1:r.sent(),r.label=2;case 2:return o.currentPaymentDetails=null,(n=b())&&jQuery(n).unblock(),[2]}}))}))}}))&&void 0!==n?n:null},t.isOpen=!1,t}();function Ut(){return r(this,void 0,void 0,(function(){var t,e,n,r;return a(this,(function(a){switch(a.label){case 0:return t=document.querySelector("form#order_review"),[4,fetch(window.location.href,{method:"POST",body:new FormData(t)})];case 1:if(e=a.sent(),n=new URL(e.url),!(r=n.searchParams.get("payment_data")))throw new Error("Invalid url query payment_data: "+n.search);return[2,JSON.parse(atob(decodeURIComponent(r)))]}}))}))}var Dt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_venmo"},n.prototype.fundingType=function(){return"venmo"},n.prototype.buttonStyle=function(){var t;return null!==(t=O("peachpay_paypal_venmo_gateway","button_style"))&&void 0!==t?t:void 0},n}(Mt),Bt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_wallet"},n.prototype.fundingType=function(){return"paypal"},n.prototype.buttonStyle=function(){var t;return null!==(t=O("peachpay_paypal_wallet_gateway","button_style"))&&void 0!==t?t:void 0},n}(Mt),$t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_paylater"},n.prototype.fundingType=function(){return"paylater"},n.prototype.buttonStyle=function(){var t;return null!==(t=O("peachpay_paypal_paylater_gateway","button_style"))&&void 0!==t?t:void 0},n}(Mt),Ht=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.gatewayId=function(){return"peachpay_paypal_credit"},n.prototype.fundingType=function(){return"credit"},n.prototype.buttonStyle=function(){var t;return null!==(t=O("peachpay_paypal_credit_gateway","button_style"))&&void 0!==t?t:void 0},n}(Mt);function Qt(){return r(this,void 0,void 0,(function(){var t,e,n,r,i,o,c,s,u,l;return a(this,(function(a){switch(a.label){case 0:return q("peachpay_paypal_gateways")?(t=O("peachpay_paypal_gateways","client_id"),e=O("peachpay_paypal_gateways","merchant_id"),n=O("peachpay_paypal_gateways","partner_attribution_id"),t&&e&&n?(r=[],q("peachpay_paypal_wallet_gateway")&&r.push(new Bt),q("peachpay_paypal_venmo_gateway")&&r.push(new Dt),q("peachpay_paypal_paylater_gateway")&&r.push(new $t),q("peachpay_paypal_credit_gateway")&&r.push(new Ht),i=function(){r.forEach((function(t){t.unmount()}))},o=function(t){r.forEach((function(e){e.gatewayId()===t&&e.mount()}))},c=function(){return d("#place_order",(function(t){t.style.display="none"}))},s=function(){return d("#place_order",(function(t){t.style.display=""}))},[4,w((function(t){i();var e=r.find((function(e){return e.gatewayId()===t}));e?(o(e.gatewayId()),c()):s()}))]):[2]):[2];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,Ot({"client-id":t,"merchant-id":e,"data-partner-attribution-id":n,"enable-funding":"venmo",currency:peachpay_checkout_data.cart_details.currency,"data-page-type":"checkout"})];case 3:return(u=a.sent())?[4,Promise.all(r.map((function(t){return t.init(u)})))]:[2];case 4:return a.sent(),[3,6];case 5:return l=a.sent(),console.error("failed to load the PayPal JS SDK script",l),[3,6];case 6:return[2]}}))}))}function Jt(t){return r(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(i){return E(t,e={peachpay_purchase_order:Gt}),P(t,e,(function(t,e){return r(n,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:if(!t)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m(peachpay_checkout_data,t,{paymentStatus:"unperformed",orderStatus:"creationfailed",note:e.join(" ")})];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}}))}))})),[2]}))}))}function Gt(t,e){return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return _(),[4,f(peachpay_checkout_data,e)];case 1:return(n=r.sent())?(v(t,n,p()),[2,!0]):[2,!1]}}))}))}function Kt(){return r(this,void 0,void 0,(function(){var t,e,n,r;return a(this,(function(a){switch(a.label){case 0:return(t=b())?(e=o(location.hash.split("="),2),n=e[0],r=e[1],"#payment_data"===n&&r&&jQuery(t).block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),l(),!peachpay_checkout_data.page.is_checkout||peachpay_checkout_data.page.is_order_received?[3,2]:(z(t),[4,Promise.all([Pt(t),Jt(t),Qt(),Lt(t),jt(t)])])):[2];case 1:return a.sent(),[3,3];case 2:peachpay_checkout_data.page.is_order_received&&function(){try{sessionStorage.removeItem(c)}catch(t){}}(),a.label=3;case 3:return"#payment_data"===n&&r&&window.dispatchEvent(new Event("hashchange")),jQuery('input[name="billing_email"],input[name="payment_method"]').on("change",(function(){jQuery(document.body).trigger("update_checkout")})),[2]}}))}))}document.addEventListener("DOMContentLoaded",(function(){return r(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2,Kt()]}))}))}))})()})();