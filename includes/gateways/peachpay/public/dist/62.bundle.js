"use strict";(self.webpackChunkpeachpay_for_woocommerce=self.webpackChunkpeachpay_for_woocommerce||[]).push([[62],{6151:(e,t,n)=>{n.r(t),n.d(t,{createVerifyBuyerDetails:()=>O,default:()=>T,handleTokenResult:()=>Q});var a=n(655),r=n(9276),i=n(9213),o=n(6673),s=n(7462),c=n(9350),u=n(7629),l=n(9970),d=n(8401),p=n(7059),h=n(7022),f=n(4071),m=n(6204),y=n(9545),v=n(1212),g=new Set(["googlepay","applepay","afterpay","cashapp"]);function b(e){p.h.subscribe((function(){!function(e,t,n){"square"!==e||"payment"!==t&&"returning"!==t?(0,y.HD)(".square-btn-container",(function(e){e.classList.add("hide"),e.classList.remove("active")})):(0,y.HD)(".square-btn-container",(function(e){e.classList.remove("hide")}));"payment"!==t&&"returning"!==t||"square"!==e||"loading"===n?(0,y.HD)(".square-btn",(function(e){e.classList.add("hide")})):g.has(u.hv.selectedProviderMethod())?((0,y.HD)(".square-btn",(function(e){e.classList.add("hide")})),(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):((0,y.HD)(".square-btn",(function(e){e.classList.remove("hide")})),(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")})))}(u.hv.selectedProvider(),s.qA.modalUI.page(),s.qA.modalUI.loadingMode()),function(e,t){var n;if("square"!==e)return;"finished"===t?(0,y.HD)(".square-btn",(function(e){e.disabled=!1})):(0,y.HD)(".square-btn",(function(e){e.disabled=!0}));"loading"===t?((0,y.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,y.HD)(".pp-btn-spinner-container ",(function(e){e.classList.add("hide")})),(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")})));g.has(u.hv.selectedProviderMethod())?"processing"===t?((0,y.HD)(".pp-btn-spinner-container",(function(e){e.classList.remove("hide")})),"cashapp"!==(null===(n=u.hv.selectedMethodConfiguration())||void 0===n?void 0:n.slug)&&(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.add("hide")}))):((0,y.HD)(".pp-btn-spinner-container",(function(e){e.classList.add("hide")})),(0,y.HD)(".square-custom-btn-container",(function(e){e.classList.remove("hide")}))):"processing"===t?((0,y.HD)(".square-btn > .button-text",(function(e){e.innerHTML=(0,f.M)("Processing")})),(0,y.HD)(".square-btn-spinner",(function(e){e.classList.remove("hide")}))):((0,y.HD)(".square-btn > .button-text",(function(e){e.innerHTML="".concat((0,f.M)("Pay")," ").concat((0,v.o)(o.AQ.total()))})),(0,y.HD)(".square-btn-spinner",(function(e){e.classList.add("hide")})))}(u.hv.selectedProvider(),s.qA.modalUI.loadingMode()),function(e){var t,n,r,i,o;if("square"!==u.hv.selectedProvider())return;var s=Object.entries(e).sort((function(e,t){var n,r,i,o,s,c=(0,a.CR)(e,2),u=(c[0],c[1]),l=(0,a.CR)(t,2);l[0];return(null!==(i=null===(r=null===(n=l[1].state)||void 0===n?void 0:n.mountTarget)||void 0===r?void 0:r.length)&&void 0!==i?i:0)-(null!==(s=null===(o=u.state)||void 0===o?void 0:o.mountTarget.length)&&void 0!==s?s:0)}));try{for(var c=(0,a.XA)(s),l=c.next();!l.done;l=c.next()){var d=(0,a.CR)(l.value,2),p=(d[0],d[1]);p.state||(p.state={mountTarget:""});var h=w();if(p.state.mountTarget&&p.state.mountTarget!==h&&(null===(r=null==p?void 0:p.detach)||void 0===r||r.call(p),p.state.mountTarget=""),u.hv.selectedProviderMethod()===p.config.slug){if(p.state.mountTarget)continue;null===(i=null==p?void 0:p.attach)||void 0===i||i.call(p,h),p.state.mountTarget=h}else{if(!p.state.mountTarget)continue;null===(o=null==p?void 0:p.detach)||void 0===o||o.call(p),p.state.mountTarget=""}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}(e)}))}function w(){return s.qA.customer.existing()?"#existing-customer-pay-button":s.qA.customer.mobile()?"#mobile-customer-pay-button":"#new-customer-pay-button"}var q=n(9536),_=n(3493),k=n(9402);var x=n(1924);function A(){var e=s.L0.metadata("peachpay_square_afterpay_gateway","title");if(e)return e;switch(l.gx.billing.country()){case"GB":case"ES":case"FR":case"IT":return"Clearpay";default:return"Afterpay"}}const z=n.p+"img/4eb6a57eeeccfe1617eb-cashapp-green.svg",S=n.p+"img/efa03ef0d084294ce629-cashapp-green-logo-only.svg";var L=n(6857),C=n(3041);function H(){var e,t,n=null,r=((t=document.createElement("div")).innerHTML="<button class=\"square-apay-btn\">\n        <style>\n            .square-apay-btn{\n                background-image: url('img/apple-pay-button.png');\n                background-color: black;\n                border: none; height: 55px;\n                width: 15rem;\n                background-size: contain;\n                border-radius: 0.2rem;\n                background-position: center;\n            }\n\n            .square-apay-btn:hover{\n                opacity: 0.8;\n            }\n        </style>\n    </button>",t.querySelector("button")),i={initialized:!1,name:null!==(e=s.L0.metadata("peachpay_square_applepay_gateway","title"))&&void 0!==e?e:(0,f.M)("Apple Pay"),slug:"applepay",gateway:"peachpay_square_applepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(C,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,f.M)("Apple Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,f.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!0,assets:{badge:{src:L},title:{src:C}}};return{config:i,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,r=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.applePay(r)];case 2:return n=a.sent(),i.initialized=!0,p.h.dispatch((0,_.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){(0,y.MW)("".concat(e," .square-custom-btn-container"),(function(e){return e.insertAdjacentElement("afterbegin",r)}))},detach:function(){r.remove()},tokenize:function(){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n?[4,n.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Apple Pay instance while attempting to tokenize the payment."}]];case 1:return[2,Q(a.sent())];case 2:return e=a.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}}}var M=n(8883),D=n(5792);var R=n(410),P=n(3172);function T(e,t){return(0,a.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:return n=s.qA.isTestOrDevSite()?"https://sandbox.web.squarecdn.com/v1/square.js":"https://web.squarecdn.com/v1/square.js",[4,(0,y.ve)(n,"Square",(function(){return(0,a.mG)(r,void 0,void 0,(function(){var n,r,i,o,c,d,h,m,v,g,w,q;return(0,a.Jh)(this,(function(L){switch(L.label){case 0:return window.Square&&(n=null===(m=null==t?void 0:t.square)||void 0===m?void 0:m.account)?(r=null!==(v=null==t?void 0:t.square.config.application_id)&&void 0!==v?v:"",i=null!==(q=null===(w=null===(g=null==t?void 0:t.square)||void 0===g?void 0:g.account)||void 0===w?void 0:w.location_id)&&void 0!==q?q:"",o=window.Square.payments(r,i),c=o.paymentRequest(I()),d={Square:window.Square,payments:o,paymentRequest:c},h=function(e){var t,n,r={};if(s.L0.enabled("peachpay_square_card_gateway")&&G(e,"card")){var i=function(){var e,t={name:null!==(e=s.L0.metadata("peachpay_square_card_gateway","title"))&&void 0!==e?e:(0,f.M)("Card"),slug:"card",gateway:"peachpay_square_card",description:"",reusable:!0,assets:{title:{src:D},badge:{src:M}}},n=null,r=null;return{config:t,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,i,o;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return t=e.payments,i={style:{".input-container":{borderWidth:"1px"}}},(0,y.HD)('div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]',(function(e){e.style.padding="0",e.style.border="unset"})),[4,t.card(i)];case 1:return(n=a.sent()).attach('#pp-pms-new div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),[4,t.card(i)];case 2:return(r=a.sent()).attach('#pp-pms-existing div.pp-pm-saved-option[data-provider="square"][data-method="card"][data-index=""]').catch((function(){})),o="",p.h.subscribe((function(){var e=u.hv.selectedPaymentMethod();e!==o&&(o=e,null==n||n.recalculateSize(),null==r||r.recalculateSize())})),[2]}}))}))},tokenize:function(e){var t;return(0,a.mG)(this,void 0,void 0,(function(){var i,o,c,u,l,d,p,h,f;return(0,a.Jh)(this,(function(m){switch(m.label){case 0:if(i=e.payments,!(o=s.qA.customer.existing()?r:n))return[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element not found while attempting to tokenize card."}]];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,o.tokenize()];case 2:return c=m.sent(),[3,4];case 3:return u=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Square Card element tokenization failed with error: ".concat(u.message)}]];case 4:if(l=(0,a.CR)(Q(c),3),d=l[0],l[1],p=l[2],!d)return[2,[null,null,p]];m.label=5;case 5:return m.trys.push([5,7,,8]),[4,i.verifyBuyer(d,O())];case 6:return h=m.sent(),[2,[d,null!==(t=null==h?void 0:h.token)&&void 0!==t?t:null,{}]];case 7:return f=m.sent(),[2,[null,null,{paymentStatus:"creationfailed",note:"Verifying Square buyer failed with error: ".concat(f.message)}]];case 8:return[2]}}))}))}}}();r.card=i}if(s.L0.enabled("peachpay_square_card_gateway")&&G(e,"googlepay")){var o=function(){var e,t=null,n={initialized:!1,name:null!==(e=s.L0.metadata("peachpay_square_googlepay_gateway","title"))&&void 0!==e?e:(0,f.M)("Google Pay"),slug:"googlepay",gateway:"peachpay_square_googlepay",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src="'.concat(P,'">\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,f.M)("Google Pay selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,f.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    "),reusable:!1,assets:{badge:{src:R},title:{src:P}}};return{config:n,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var r,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:r=e.payments,i=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.googlePay(i)];case 2:return t=a.sent(),n.initialized=!0,p.h.dispatch((0,_.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){null==t||t.attach(e+" .square-custom-btn-container",{buttonColor:"black",buttonSizeMode:"fill"}).catch((function(){}))},detach:function(){null==t||t.detach().catch((function(){}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t?[4,t.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Google Pay instance while attempting to tokenize the payment."}]];case 1:return[2,Q(a.sent())];case 2:return e=a.sent(),n={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(n.note=e.message),[2,[null,null,n]];case 3:return[2]}}))}))}}}();r.googlepay=o}if(s.L0.enabled("peachpay_square_applepay_gateway")&&G(e,"applepay")){var c=H();r.applepay=c}if(s.L0.enabled("peachpay_square_ach_gateway")&&G(e,"ach")){var d=function(){var e,t=null,n={initialized:!1,name:null!==(e=s.L0.metadata("peachpay_square_ach_gateway","title"))&&void 0!==e?e:(0,f.M)("US Bank Account"),slug:"us_bank_account",gateway:"peachpay_square_ach",description:'\n\t<p style="margin: 0;">\n\t\t'.concat((0,f.M)("After selecting <b>Pay</b> a prompt will appear to select a bank account."),'\n\t</p>\n\t<hr>\n\t<p class="muted" style="margin: 0;">\n\t\t').concat((0,f.M)("Note: Payments may take up to 5 days to complete."),"\n\t</p>\n\t"),reusable:!1,assets:{badge:{src:k},title:{src:k}}};return{config:n,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:r=e.payments,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.ach({redirectURI:window.location.href,transactionId:"0"})];case 2:return(t=a.sent()).addEventListener("ontokenization",(function(e){})),n.initialized=!0,p.h.dispatch((0,_.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t?[4,t.tokenize({accountHolderName:l.gx.billing.fullName()})]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find ACH Bank instance while attempting to tokenize the payment."}]];case 1:return[2,Q(a.sent())];case 2:return e=a.sent(),n={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(n.note=e.message),[2,[null,null,n]];case 3:return[2]}}))}))}}}();r.ach=d}if(s.L0.enabled("peachpay_square_afterpay_gateway")&&G(e,"afterpay")){var h=(v=null,g={initialized:!1,name:A(),slug:"afterpay",gateway:"peachpay_square_afterpay",description:(m=A(),'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(x,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat(m," ").concat((0,f.M)("selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,f.M)("Another step will appear after submitting your order to complete your purchase details."),"<p>\n    ")),reusable:!1,assets:{title:{src:x},badge:{src:x}}},p.h.subscribe((function(){g.name=A(),(0,y.HD)('.pp-pm-type[data-method="afterpay"][data-provider="square"]',(function(e){var t=e.querySelector("span");t&&(t.innerText=g.name)}))})),{config:g,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:t=e.payments,n=e.paymentRequest,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.afterpayClearpay(n)];case 2:return v=a.sent(),g.initialized=!0,p.h.dispatch((0,_.s)()),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}}))}))},attach:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return(0,y.HD)(".square-custom-btn-container").forEach((function(e){var t=document.createElement("div");t.className="square-afterpay-wrapper",t.style.width="250px",t.style.height="100%",e.appendChild(t)})),[4,null==v?void 0:v.attach(e+" .square-afterpay-wrapper",{buttonColor:"black",buttonType:"checkout_with_afterpay",finalCtaButtonType:"buy_now"})];case 1:return t.sent(),[2]}}))}))},detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return[4,null==v?void 0:v.detach()];case 1:return e.sent(),(0,y.HD)(".square-afterpay-wrapper").forEach((function(e){e.remove()})),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),v?[4,v.tokenize()]:[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to Afterpay/Clearpay instance while attempting to tokenize the payment."}]];case 1:return[2,Q(n.sent())];case 2:return e=n.sent(),t={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},e instanceof Error&&(t.note=e.message),[2,[null,null,t]];case 3:return[2]}}))}))}});r.afterpay=h}var m,v,g;if(s.L0.enabled("peachpay_square_cashapp_gateway")&&G(e,"cashapp")){var b=function(){var e,t=this,n=null,r={initialized:!1,name:null!==(e=s.L0.metadata("peachpay_square_cashapp_gateway","title"))&&void 0!==e?e:(0,f.M)("Cash App"),slug:"cashapp",gateway:"peachpay_square_cashapp",description:'\n<img style="display: block; text-align: left; height: 1.5rem; " src='.concat(z,'>\n<p style="text-align: left; margin: 0.5rem 0;">').concat((0,f.M)("Cash App selected for checkout."),'</p>\n<hr/>\n<p style="text-align: left; margin: 0.5rem 0 0;" class="muted">').concat((0,f.M)("After pressing the Cash App button you'll be prompted to scan a QR code or approve the payment through the Cash App mobile app."),"<p>\n    "),reusable:!1,assets:{title:{src:z},badge:{src:S}}},i=function(e){return(0,a.mG)(t,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return[4,null==n?void 0:n.attach(e+" .square-custom-btn-container",{shape:"semiround",size:"medium"})];case 1:return t.sent(),[2]}}))}))},o=null,c=null;function u(e){return(0,a.mG)(this,void 0,void 0,(function(){var t,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return t=e.payments,r=e.paymentRequest,[4,t.cashAppPay(r,{redirectURL:window.location.href})];case 1:return(n=a.sent()).addEventListener("ontokenization",(function(e){e.detail.tokenResult&&o?o(e.detail.tokenResult):c&&c("An unknown tokenization error occured")})),[4,i("")];case 2:return a.sent(),[4,n.detach()];case 3:return a.sent(),[2]}}))}))}return{config:r,activate:function(e){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,u(e)];case 1:return t.sent(),r.initialized=!0,p.h.dispatch((0,_.s)()),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},attach:i,detach:function(){return(0,a.mG)(this,void 0,void 0,(function(){return(0,a.Jh)(this,(function(e){switch(e.label){case 0:return c&&c("method detached"),[4,null==n?void 0:n.detach()];case 1:return e.sent(),[2]}}))}))},tokenize:function(e){return(0,a.mG)(this,void 0,void 0,(function(){var e,t,r,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),n?(e=new Promise((function(e,t){o=e,c=t})),t=Q,[4,e]):[2,[null,null,{paymentStatus:"creationfailed",note:"Failed to find Cash App instance while attempting to tokenize the payment."}]];case 1:return[2,t.apply(void 0,[a.sent()])];case 2:return r=a.sent(),i={paymentStatus:"creationfailed",note:"An unknown exception occured while tokenizing the payment."},r instanceof Error&&(i.note=r.message),[2,[null,null,i]];case 3:return[2]}}))}))}}}();r.cashapp=b}var w={methods:{}};try{for(var q=(0,a.XA)(Object.entries(r)),L=q.next();!L.done;L=q.next()){var C=(0,a.CR)(L.value,2),T=C[0],J=C[1];w.methods[T]=J.config}}catch(e){t={error:e}}finally{try{L&&!L.done&&(n=q.return)&&n.call(q)}finally{if(t)throw t.error}}return p.h.dispatch((0,u.DK)({square:w})),r}(n),[4,J(d,h,e)]):[2];case 1:return L.sent(),function(e){var t=e.paymentRequest,n="";p.h.subscribe((function(){var e=I(),a=JSON.stringify(e);n!==a&&"finished"===s.qA.modalUI.loadingMode()&&"square"===u.hv.selectedProvider()&&(n=a,t.update(e))}))}(d),b(h),p.h.dispatch((0,u.TA)()),[2]}}))}))}))];case 1:return i.sent(),[2]}}))}))}function G(e,t){var n=!1;switch(t){case"cashapp":case"afterpay":case"ach":n=!0;break;case"card":case"applepay":case"googlepay":n=e.capabilities.includes("CREDIT_CARD_PROCESSING");break;default:n=!1}return n}function J(e,t,n){return(0,a.mG)(this,void 0,void 0,(function(){var i,o,s,c,l,d,p,h,f,m=this;return(0,a.Jh)(this,(function(v){switch(v.label){case 0:i=[],o=!1;try{for(s=(0,a.XA)(Object.entries(t)),c=s.next();!c.done;c=s.next())l=(0,a.CR)(c.value,2),l[0],(d=l[1]).activate&&i.push(null==d?void 0:d.activate(e))}catch(e){h={error:e}}finally{try{c&&!c.done&&(f=s.return)&&f.call(s)}finally{if(h)throw h.error}}v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return v.sent(),[3,4];case 3:return v.sent(),[3,4];case 4:return p=function(i){return(0,a.mG)(m,void 0,void 0,(function(){var s,c,l,d;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return(0,r.N6)()?(s=i.target,((null==s?void 0:s.closest("button"))||(null===(d=null===(l=null==s?void 0:s.closest("div"))||void 0===l?void 0:l.shadowRoot)||void 0===d?void 0:d.querySelector("button")))&&(c=t[u.hv.selectedProviderMethod()])&&"square"===u.hv.selectedProvider()?o?[3,2]:(o=!0,[4,E(e,c,n)]):[2]):[2];case 1:a.sent(),o=!1,a.label=2;case 2:return[2]}}))}))},(0,y.HD)(".square-btn",(function(e){e.addEventListener("click",p)})),(0,y.HD)(".square-custom-btn-container",(function(e){e.addEventListener("click",p)})),[2]}}))}))}function E(e,t,n){return(0,a.mG)(this,void 0,void 0,(function(){var r,o,c,h,f,y,v,g;return(0,a.Jh)(this,(function(b){switch(b.label){case 0:return"peachpay_square_cashapp"!==t.config.gateway&&p.h.dispatch((0,s.N5)()),[4,t.tokenize(e)];case 1:return r=a.CR.apply(void 0,[b.sent(),3]),o=r[0],c=r[1],h=r[2],[4,n.startTransaction(t.config.gateway)];case 2:return f=b.sent(),o&&f?[3,4]:("returning"===s.qA.modalUI.page()&&(0,q.yH)("payment"),[4,null==f?void 0:f.complete(h)]);case 3:return b.sent(),p.h.dispatch((0,s.tv)()),[2];case 4:return y={peachpay_session_id:d.Z5.sessionId(),peachpay_transaction_id:f.getId(),peachpay_square_source_id:o},c&&(y.peachpay_square_verification_id=c),[4,n.placeOrder(f,y)];case 5:return"failure"!==(v=b.sent()).result?[3,7]:[4,f.complete()];case 6:return b.sent(),p.h.dispatch((0,s.tv)()),[2];case 7:return p.h.dispatch((0,l.ud)({provider:u.hv.selectedProvider(),method:u.hv.selectedProviderMethod()})),[4,(0,i.ll)()];case 8:return b.sent(),(0,m.c)(),g=n.getOrderRedirect(v),window.top?[4,f.complete()]:[3,10];case 9:b.sent(),window.top.location=g,b.label=10;case 10:return[2]}}))}))}function I(){var e,t;return{countryCode:null!==(t=null===(e=c.l9.general.wcLocationInfoData())||void 0===e?void 0:e.store_country)&&void 0!==t?t:"US",currencyCode:c.l9.currency.code(),lineItems:N(),discounts:F(),taxLineItems:[{label:(0,f.M)("Tax"),amount:o.AQ.totalTax().toFixed(2)}],total:{label:(0,f.M)("Total"),amount:(0===o.AQ.total()?1:o.AQ.total()).toFixed(2)}}}function N(){var e,t,n,r=new Array;try{for(var i=(0,a.XA)(o.AQ.contents()),s=i.next();!s.done;s=i.next()){var c=s.value;r.push({label:c.name+" Ã— "+(0,h.Qw)(c),amount:(Number.parseFloat(null!==(n=c.display_price)&&void 0!==n?n:c.price)*(0,h.Qw)(c)).toFixed(2)})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r}function F(){var e,t,n=new Array;try{for(var r=(0,a.XA)(Object.entries(o.AQ.couponRecord())),i=r.next();!i.done;i=r.next()){var s=(0,a.CR)(i.value,2),c=s[0],u=s[1];u&&n.push({id:c,amount:u.toFixed(2),label:c})}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n}function O(){var e={addressLines:[l.gx.billing.address1(),l.gx.billing.address2()],city:l.gx.billing.city(),countryCode:l.gx.billing.country(),email:l.gx.billing.email(),familyName:l.gx.billing.lastName(),givenName:l.gx.billing.firstName(),phone:l.gx.billing.phone(),state:l.gx.billing.state(),postalCode:l.gx.billing.postal()};return o.AQ.total()>0?{intent:"CHARGE",currencyCode:c.l9.currency.code(),amount:String(o.AQ.total()),billingContact:e}:{intent:"STORE",billingContact:e}}function Q(e){var t=function(){var t="";return e.errors&&Array.isArray(e.errors)&&e.errors.forEach((function(e){t+=e.message+". "})),t};switch(e.status){case"OK":return[e.token,null,{}];case"Cancel":return[null,null,{note:"Customer canceled the Payment. "+t(),paymentStatus:"canceled"}];case"Abort":return[null,null,{note:"Tokenizing the payment method was aborted. "+t(),paymentStatus:"creationfailed"}];case"Error":return[null,null,{note:"Tokenizing the payment method encountered an error. "+t(),paymentStatus:"creationfailed"}];case"Invalid":return[null,null,{note:t(),paymentStatus:"creationfailed"}];default:return[null,null,{note:"Tokenizing the payment method encountered an unknown status. "+t(),paymentStatus:"creationfailed"}]}}},6857:(e,t,n)=>{e.exports=n.p+"img/d0db1eb027413f38ddb3-apple-pay.svg"},8883:(e,t,n)=>{e.exports=n.p+"img/d2a66f3e82ab3efab425-card.svg"},410:(e,t,n)=>{e.exports=n.p+"img/7aba4ceea17fbd040a20-google-pay.svg"},1924:(e,t,n)=>{e.exports=n.p+"img/070ee8f2835a668d3bed-afterpay.svg"},3041:(e,t,n)=>{e.exports=n.p+"img/0a580c7c9daca59b189c-apple-pay.svg"},9402:(e,t,n)=>{e.exports=n.p+"img/e7542fee9125d1af4d23-bank.svg"},5792:(e,t,n)=>{e.exports=n.p+"img/b2c8b12eb49165de87d5-credit-card-regular.svg"},3172:(e,t,n)=>{e.exports=n.p+"img/b6a9922efb467e7f87c3-google-pay.svg"}}]);